---
title: "R Code meta-analysis career exploration"
author: "Anne"
date: "1/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Read in data and preparation

```{r}

library(tidyverse)
library(psychmeta)
library(readxl)
getwd()
db <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx") %>% filter(., Only_one_scale == 'N')
intercor <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx", sheet = "Intercor")

cols.num <- c("Sample_number","Year", "N", "Ryy_Exploration", "Rxx_Criterion", "Rxy", "Item_number",
              "Prct_female", "M_age", "SD_age", "Ux")
cols.num_intercor <- c("Intercor_ID", "Intercor_rxy", "Intercor_N")
db[cols.num] <- sapply(db[cols.num],as.numeric) # make some cols numeric
intercor[cols.num_intercor] <- sapply(intercor[cols.num_intercor],as.numeric) # make some cols numeric

reverse <- function(x) {  
  reversed <- x*(-1)
  return(reversed)
}

db <- db %>% # reverse Rxy for reverse coded constructs
  mutate(Rxy = ifelse(.$Reverse == 'Y', reverse(Rxy), Rxy))

intercor <- intercor %>% # reverse Rxy for reverse coded constructs
  mutate(Intercor_rxy = ifelse(.$Intercor_reverse == 'Y', reverse(Intercor_rxy), Intercor_rxy))

```

# Barebones and individually corrected meta-analysis

```{r}
library(psychmeta)

# Intercorrelations 
intercor_cons <-  control_intercor(rxyi = Intercor_rxy, n = Intercor_N, sample_id = Intercor_ID, construct_x = Intercor_x, construct_y = Intercor_y, data = intercor, intercor_scalar = 0.5)

intercor_cons_f <-  control_intercor(rxyi = Intercor_rxy, n = Intercor_N, sample_id = Intercor_ID, construct_x = Intercor_x_f, construct_y = Intercor_y_f, data = intercor, intercor_scalar = 0.5)
```


## Career-exploration self-efficacy

```{r}

# Career exploration self-efficacy
db_CESE <- db %>% filter(., CRITERION_b == 'Career-related self-efficacy') 
ma_res_CESE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_CESE)
CESE_out_ic <- summary(ma_res_CESE)
get_escalc(ma_res_CESE)$`analysis_id: 1`$individual_correction$true_score
CESE <- get_metatab(CESE_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_CESE <- heterogeneity(ma_obj = ma_res_CESE)
var_arti <- (heterogeneity(ma_het_CESE)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
CESE <- cbind(CESE, var_arti)


db_CESE_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == 'Career-related self-efficacy')) 
ma_res_CESE_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    #intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_CESE_Env)
CESE_out_ic_Env <- summary(ma_res_CESE_Env)
CESE_Env <- get_metatab(CESE_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_CESE_Env <- heterogeneity(ma_obj = ma_res_CESE_Env)
var_arti <- (heterogeneity(ma_het_CESE_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
CESE_Env <- cbind(CESE_Env, var_arti)

db_CESE_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == 'Career-related self-efficacy')) 
ma_res_CESE_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_CESE_Self)
CESE_out_ic_Self <- summary(ma_res_CESE_Self)
CESE_Self <- get_metatab(CESE_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_CESE_Self <- heterogeneity(ma_obj = ma_res_CESE_Self)
var_arti <- (heterogeneity(ma_het_CESE_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
CESE_Self <- cbind(CESE_Self, var_arti)

```

## Outcome expectations

```{r}
# Outcome expectations 
db_expect <- db %>% filter(., CRITERION_b == "Outcome expectations") 
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect)
expect <- get_metatab(expect_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80, sd_r_c)
ma_het_expect <- heterogeneity(ma_obj = ma_res_expect)
var_arti <- (heterogeneity(ma_het_expect)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
expectoverall <- as.data.frame(cbind(expect, var_arti))


db_expect_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Outcome expectations")) 
ma_res_expect_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Env)
expect_out_ic_Env <- summary(ma_res_expect_Env)
expect_Env <- get_metatab(expect_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Env <- heterogeneity(ma_obj = ma_res_expect_Env)
var_arti <- (heterogeneity(ma_het_expect_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
expectoverall_Env <- as.data.frame(cbind(expect_Env, var_arti))

db_expect_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Outcome expectations")) 
ma_res_expect_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Self)
expect_out_ic_Self <- summary(ma_res_expect_Self)
expect_Self <- get_metatab(expect_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Self <- heterogeneity(ma_obj = ma_res_expect_Self)
var_arti <- (heterogeneity(ma_het_expect_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
expectoverall_Self <- as.data.frame(cbind(expect_Self, var_arti))
```

```{r}
# Enviornment outcome expectations 
db_expect <- db %>% filter(., CRITERION_f == "environment outcome expectation") 
ma_res_expect_env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect_env)
expect <- get_metatab(expect_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80, sd_r_c)
ma_het_expect <- heterogeneity(ma_obj = ma_res_expect_env)
var_arti <- (heterogeneity(ma_het_expect)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
env_expect <- cbind(expect, var_arti)

db_expect_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "environment outcome expectation")) 
ma_res_expect_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Env)
expect_out_ic_Env <- summary(ma_res_expect_Env)
expect_Env <- get_metatab(expect_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Env <- heterogeneity(ma_obj = ma_res_expect_Env)
var_arti <- (heterogeneity(ma_het_expect_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
env_expect_Env <- cbind(expect_Env, var_arti)

db_expect_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "environment outcome expectation")) 
ma_res_expect_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Self)
expect_out_ic_Self <- summary(ma_res_expect_Self)
expect_Self <- get_metatab(expect_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Self <- heterogeneity(ma_obj = ma_res_expect_Self)
var_arti <- (heterogeneity(ma_het_expect_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
env_expect_Self <- cbind(expect_Self, var_arti)
```

```{r}
# Self outcome expectations 
db_expect <- db %>% filter(., CRITERION_f == "self outcome expectation") 
ma_res_expect_self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect)
expect <- get_metatab(expect_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80, sd_r_c)
ma_het_expect <- heterogeneity(ma_obj = ma_res_expect)
var_arti <- (heterogeneity(ma_het_expect)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
self_expect <- cbind(expect, var_arti)

db_expect_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "self outcome expectation")) 
ma_res_expect_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Env)
expect_out_ic_Env <- summary(ma_res_expect_Env)
expect_Env <- get_metatab(expect_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Env <- heterogeneity(ma_obj = ma_res_expect_Env)
var_arti <- (heterogeneity(ma_het_expect_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
self_expect_Env <- cbind(expect_Env, var_arti)

db_expect_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "self outcome expectation")) 
ma_res_expect_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Self)
expect_out_ic_Self <- summary(ma_res_expect_Self)
expect_Self <- get_metatab(expect_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Self <- heterogeneity(ma_obj = ma_res_expect_Self)
var_arti <- (heterogeneity(ma_het_expect_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
self_expect_Self <- cbind(expect_Self, var_arti)
```

```{r}
# Overall outcome expectations 
db_expect <- db %>% filter(., CRITERION_f == "overall outcome expectation") 
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect)
expect <- get_metatab(expect_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80, sd_r_c)
ma_het_expect <- heterogeneity(ma_obj = ma_res_expect)
var_arti <- (heterogeneity(ma_het_expect)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
overall_expect <- cbind(expect, var_arti)

db_expect_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "overall outcome expectation")) 
ma_res_expect_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Env)
expect_out_ic_Env <- summary(ma_res_expect_Env)
expect_Env <- get_metatab(expect_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Env <- heterogeneity(ma_obj = ma_res_expect_Env)
var_arti <- (heterogeneity(ma_het_expect_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
overall_expect_Env <- cbind(expect_Env, var_arti)

db_expect_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "overall outcome expectation")) 
ma_res_expect_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect_Self)
expect_out_ic_Self <- summary(ma_res_expect_Self)
expect_Self <- get_metatab(expect_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_expect_Self <- heterogeneity(ma_obj = ma_res_expect_Self)
var_arti <- (heterogeneity(ma_het_expect_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
overall_expect_Self <- cbind(expect_Self, var_arti)
```

## Career exploration goals

```{r}
# Career engagement goals
db_Goals <- db %>% filter(., CRITERION_b == 'Career engagement goals') 
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Goals)
goals_out_ic <- summary(ma_res_goals)
goals <- get_metatab(goals_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_goals <- heterogeneity(ma_obj = ma_res_goals)
var_arti <- (heterogeneity(ma_het_goals)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
goals <- cbind(goals, var_arti)

db_Goals_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Career engagement goals")) 
ma_res_Goals_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Goals_Env)
Goals_out_ic_Env <- summary(ma_res_Goals_Env)
Goals_Env <- get_metatab(Goals_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_Goals_Env <- heterogeneity(ma_obj = ma_res_Goals_Env)
var_arti <- (heterogeneity(ma_het_Goals_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
Goals_Env <- cbind(Goals_Env, var_arti)

db_Goals_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Career engagement goals")) 
ma_res_Goals_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Goals_Self)
Goals_out_ic_Self <- summary(ma_res_Goals_Self)
Goals_Self <- get_metatab(Goals_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_Goals_Self <- heterogeneity(ma_obj = ma_res_Goals_Self)
var_arti <- (heterogeneity(ma_het_Goals_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
Goals_Self <- cbind(Goals_Self, var_arti)
```

## Personality 

```{r}
# Openness
db_Open <- db %>% filter(., CRITERION_b == 'Openness') 
ma_res_open <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Open)
open_out_ic <- summary(ma_res_open)
open <- get_metatab(open_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_open <- heterogeneity(ma_obj = ma_res_open)
var_arti <- (heterogeneity(ma_het_open)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
open <- cbind(open, var_arti)

db_open_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Openness")) 
ma_res_open_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_open_Env)
open_out_ic_Env <- summary(ma_res_open_Env)
open_Env <- get_metatab(open_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_open_Env <- heterogeneity(ma_obj = ma_res_open_Env)
var_arti <- (heterogeneity(ma_het_open_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
open_Env <- cbind(open_Env, var_arti)

db_open_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Openness")) 
ma_res_open_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_open_Self)
open_out_ic_Self <- summary(ma_res_open_Self)
open_Self <- get_metatab(open_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_open_Self <- heterogeneity(ma_obj = ma_res_open_Self)
var_arti <- (heterogeneity(ma_het_open_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
open_Self <- cbind(open_Self, var_arti)
```


```{r}
# Conscientiousness
db_Consc <- db %>% filter(., CRITERION_b == 'Conscientiousness') 
ma_res_consc <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Consc)
consc_out_ic <- summary(ma_res_consc)
consc <- get_metatab(consc_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_consc <- heterogeneity(ma_obj = ma_res_consc)
var_arti <- (heterogeneity(ma_het_consc)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
consc <- cbind(consc, var_arti)

db_consc_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Conscientiousness")) 
ma_res_consc_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_consc_Env)
consc_out_ic_Env <- summary(ma_res_consc_Env)
consc_Env <- get_metatab(consc_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_consc_Env <- heterogeneity(ma_obj = ma_res_consc_Env)
var_arti <- (heterogeneity(ma_het_consc_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
consc_Env <- cbind(consc_Env, var_arti)

db_consc_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Conscientiousness")) 
ma_res_consc_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_consc_Self)
consc_out_ic_Self <- summary(ma_res_consc_Self)
consc_Self <- get_metatab(consc_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_consc_Self <- heterogeneity(ma_obj = ma_res_consc_Self)
var_arti <- (heterogeneity(ma_het_consc_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
consc_Self <- cbind(consc_Self, var_arti)
```


```{r}
# Extraversion
db_Extrav <- db %>% filter(., CRITERION_b == 'Extraversion') 
ma_res_extra <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Extrav)
extra_out_ic <- summary(ma_res_extra)
extra <- get_metatab(extra_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_extra <- heterogeneity(ma_obj = ma_res_extra)
var_arti <- (heterogeneity(ma_het_extra)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
extra <- cbind(extra, var_arti)

db_extra_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Extraversion")) 
ma_res_extra_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_extra_Env)
extra_out_ic_Env <- summary(ma_res_extra_Env)
extra_Env <- get_metatab(extra_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_extra_Env <- heterogeneity(ma_obj = ma_res_extra_Env)
var_arti <- (heterogeneity(ma_het_extra_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
extra_Env <- cbind(extra_Env, var_arti)

db_extra_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Extraversion")) 
ma_res_extra_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_extra_Self)
extra_out_ic_Self <- summary(ma_res_extra_Self)
extra_Self <- get_metatab(extra_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_extra_Self <- heterogeneity(ma_obj = ma_res_extra_Self)
var_arti <- (heterogeneity(ma_het_extra_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
extra_Self <- cbind(extra_Self, var_arti)
```


```{r}
# Neuroticism
db_Neurot <- db %>% filter(., CRITERION_b == 'Neuroticism') 
ma_res_neuro <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Neurot)
neuro_out_ic <- summary(ma_res_neuro)
neuro <- get_metatab(neuro_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_neuro <- heterogeneity(ma_obj = ma_res_neuro)
var_arti <- (heterogeneity(ma_het_neuro)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
neuro <- cbind(neuro, var_arti)

db_neuro_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Neuroticism")) 
ma_res_neuro_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_neuro_Env)
neuro_out_ic_Env <- summary(ma_res_neuro_Env)
neuro_Env <- get_metatab(neuro_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_neuro_Env <- heterogeneity(ma_obj = ma_res_neuro_Env)
var_arti <- (heterogeneity(ma_het_neuro_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
neuro_Env <- cbind(neuro_Env, var_arti)

db_neuro_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Neuroticism")) 
ma_res_neuro_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_neuro_Self)
neuro_out_ic_Self <- summary(ma_res_neuro_Self)
neuro_Self <- get_metatab(neuro_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_neuro_Self <- heterogeneity(ma_obj = ma_res_neuro_Self)
var_arti <- (heterogeneity(ma_het_neuro_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
neuro_Self <- cbind(neuro_Self, var_arti)
```


```{r}
# Agreeableness
db_Agreeab <- db %>% filter(., CRITERION_b == 'Agreeableness') 
ma_res_agree <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Agreeab)
agree_out_ic <- summary(ma_res_agree)
agree <- get_metatab(agree_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_agree <- heterogeneity(ma_obj = ma_res_agree)
var_arti <- (heterogeneity(ma_het_agree)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
agree <- cbind(agree, var_arti)

db_agree_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Agreeableness")) 
ma_res_agree_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_agree_Env)
agree_out_ic_Env <- summary(ma_res_agree_Env)
agree_Env <- get_metatab(agree_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_agree_Env <- heterogeneity(ma_obj = ma_res_agree_Env)
var_arti <- (heterogeneity(ma_het_agree_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
agree_Env <- cbind(agree_Env, var_arti)

db_agree_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Agreeableness")) 
ma_res_agree_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_agree_Self)
agree_out_ic_Self <- summary(ma_res_agree_Self)
agree_Self <- get_metatab(agree_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_agree_Self <- heterogeneity(ma_obj = ma_res_agree_Self)
var_arti <- (heterogeneity(ma_het_agree_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
agree_Self <- cbind(agree_Self, var_arti)
```

## Social support

```{r}
# Career-related social support
db_Support <- db %>% filter(., CRITERION_b == 'Career-related social support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
supportoverall <- as.data.frame(cbind(support, var_arti))

db_support_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Career-related social support")) 
ma_res_support_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Env)
support_out_ic_Env <- summary(ma_res_support_Env)
support_Env <- get_metatab(support_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Env <- heterogeneity(ma_obj = ma_res_support_Env)
var_arti <- (heterogeneity(ma_het_support_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
supportoverall_Env <- cbind(support_Env, var_arti) %>% as.data.frame(.)

db_support_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Career-related social support")) 
ma_res_support_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Self)
support_out_ic_Self <- summary(ma_res_support_Self)
support_Self <- get_metatab(support_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Self <- heterogeneity(ma_obj = ma_res_support_Self)
var_arti <- (heterogeneity(ma_het_support_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
supportoverall_Self <- cbind(support_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# family support
db_Support <- db %>% filter(., CRITERION_f == 'Family support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
family_support <- cbind(support, var_arti)%>% as.data.frame(.)

db_support_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Family support")) 
ma_res_support_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Env)
support_out_ic_Env <- summary(ma_res_support_Env)
support_Env <- get_metatab(support_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Env <- heterogeneity(ma_obj = ma_res_support_Env)
var_arti <- (heterogeneity(ma_het_support_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
family_support_Env <- cbind(support_Env, var_arti)%>% as.data.frame(.)

db_support_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Family support")) 
ma_res_support_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Self)
support_out_ic_Self <- summary(ma_res_support_Self)
support_Self <- get_metatab(support_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Self <- heterogeneity(ma_obj = ma_res_support_Self)
var_arti <- (heterogeneity(ma_het_support_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
family_support_Self <- cbind(support_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# peer support
db_Support <- db %>% filter(., CRITERION_f == 'Peer support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
peer_support <- cbind(support, var_arti)%>% as.data.frame(.)

db_peer_support_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Peer support")) 

db_support_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Peer support")) 
```

```{r}
# institutional support
db_Support <- db %>% filter(., CRITERION_f == 'Institutional support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
institutional_support <- cbind(support, var_arti)%>% as.data.frame(.)

db_support_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Institutional support")) 
ma_res_support_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Env)
support_out_ic_Env <- summary(ma_res_support_Env)
support_Env <- get_metatab(support_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Env <- heterogeneity(ma_obj = ma_res_support_Env)
var_arti <- (heterogeneity(ma_het_support_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
institutional_support_Env <- cbind(support_Env, var_arti)%>% as.data.frame(.)

db_support_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Institutional support")) 
ma_res_support_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_support_Self)
support_out_ic_Self <- summary(ma_res_support_Self)
support_Self <- get_metatab(support_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support_Self <- heterogeneity(ma_obj = ma_res_support_Self)
var_arti <- (heterogeneity(ma_het_support_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
institutional_support_Self <- cbind(support_Self, var_arti)%>% as.data.frame(.)
```

```{r}
# unspecific support
db_Support <- db %>% filter(., CRITERION_f == 'Unspecific support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
unspecific_support <- cbind(support, var_arti)%>% as.data.frame(.)

db_unspecific_support_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Unspecific support")) 

db_unspecific_support_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Unspecific support")) 
```

## Barriers

```{r}
# Barriers
db_Barriers <- db %>% filter(., CRITERION_b == 'Barriers') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Barriers)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
barriersoverall <- cbind(barriers, var_arti)%>% as.data.frame(.)

db_barriers_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Barriers")) 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_barriers_Env)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
barriersoverall_Env <- cbind(barriers, var_arti)%>% as.data.frame(.)


db_barriers_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Barriers")) 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_barriers_Self)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
barriersoverall_Self <- cbind(barriers, var_arti)%>% as.data.frame(.)

```

```{r}
# Interactional Barriers
db_Barriers <- db %>% filter(., CRITERION_f == 'Interactional') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Barriers)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
interactional_barriers <- cbind(barriers, var_arti)

```


```{r}
# Social Barriers
db_Barriers <- db %>% filter(., CRITERION_f == 'Social') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Barriers)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
social_barriers <- cbind(barriers, var_arti)%>% as.data.frame(.)

db_barriers_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == 'Social')) 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_barriers_Env)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
social_barriers_Env <- cbind(barriers, var_arti)%>% as.data.frame(.)

db_barriers_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == 'Social')) 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_barriers_Self)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
social_barriers_Self <- cbind(barriers, var_arti)%>% as.data.frame(.)
```



```{r}
# Overall Barriers
db_Barriers <- db %>% filter(., CRITERION_f == 'Overall') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Barriers)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
overall_barriers <- cbind(barriers, var_arti)
```

## Career decidedness

```{r}
# Career decidedness
db_Decided <- db %>% filter(., CRITERION_b == 'Career decidedness') 

ma_res_decided <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Decided)
decided_out_ic <- summary(ma_res_decided)
decided <- get_metatab(decided_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided <- heterogeneity(ma_obj = ma_res_decided)
var_arti <- (heterogeneity(ma_res_decided)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedoverall <- cbind(decided, var_arti) %>% as.data.frame(.)

db_decided_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Career decidedness")) 
ma_res_decided_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Env)
decided_out_ic_Env <- summary(ma_res_decided_Env)
decided_Env <- get_metatab(decided_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Env <- heterogeneity(ma_obj = ma_res_decided_Env)
var_arti <- (heterogeneity(ma_het_decided_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedoverall_Env <- cbind(decided_Env, var_arti)%>% as.data.frame(.)

db_decided_Self<- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Career decidedness")) 
ma_res_decided_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Self)
decided_out_ic_Self <- summary(ma_res_decided_Self)
decided_Self <- get_metatab(decided_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Self <- heterogeneity(ma_obj = ma_res_decided_Self)
var_arti <- (heterogeneity(ma_het_decided_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedoverall_Self <- cbind(decided_Self, var_arti)%>% as.data.frame(.)
```

```{r}
# Career decidedness
db_Decided <- db %>% filter(., CRITERION_f == 'Career decidedness') 
ma_res_decided <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Decided)
decided_out_ic <- summary(ma_res_decided)
decided <- get_metatab(decided_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided <- heterogeneity(ma_obj = ma_res_decided)
var_arti <- (heterogeneity(ma_res_decided)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedness <- cbind(decided, var_arti)%>% as.data.frame(.)

db_decided_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Career decidedness")) 
ma_res_decided_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Env)
decided_out_ic_Env <- summary(ma_res_decided_Env)
decided_Env <- get_metatab(decided_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Env <- heterogeneity(ma_obj = ma_res_decided_Env)
var_arti <- (heterogeneity(ma_het_decided_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedness_Env <- cbind(decided_Env, var_arti)%>% as.data.frame(.)

db_decided_Self<- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Career decidedness")) 
ma_res_decided_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Self)
decided_out_ic_Self <- summary(ma_res_decided_Self)
decided_Self <- get_metatab(decided_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Self <- heterogeneity(ma_obj = ma_res_decided_Self)
var_arti <- (heterogeneity(ma_het_decided_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedness_Self <- cbind(decided_Self, var_arti)%>% as.data.frame(.)
```

```{r}
# Career undecidedness
db_undecided <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx") %>% filter(., Only_one_scale == 'N')
intercor <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx", sheet = "Intercor")

cols.num <- c("Sample_number","Year", "N", "Ryy_Exploration", "Rxx_Criterion", "Rxy", "Item_number",
              "Prct_female", "M_age", "SD_age", "Ux")
cols.num_intercor <- c("Intercor_ID", "Intercor_rxy", "Intercor_N")
db_undecided[cols.num] <- sapply(db_undecided[cols.num],as.numeric) # make some cols numeric
intercor[cols.num_intercor] <- sapply(intercor[cols.num_intercor],as.numeric) # make some cols numeric


db_Decided <- db_undecided %>% filter(., CRITERION_f == 'Career indecision') 
ma_res_decided <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Decided)
decided_out_ic <- summary(ma_res_decided)
decided <- get_metatab(decided_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided <- heterogeneity(ma_obj = ma_res_decided)
var_arti <- (heterogeneity(ma_res_decided)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
indecision <- cbind(decided, var_arti)%>% as.data.frame(.)

db_decided_Env <- db_undecided %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Career indecision")) 
ma_res_decided_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Env)
decided_out_ic_Env <- summary(ma_res_decided_Env)
decided_Env <- get_metatab(decided_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Env <- heterogeneity(ma_obj = ma_res_decided_Env)
var_arti <- (heterogeneity(ma_het_decided_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
indecision_Env <- cbind(decided_Env, var_arti)%>% as.data.frame(.)

db_decided_Self<- db_undecided %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Career indecision")) 
ma_res_decided_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_decided_Self)
decided_out_ic_Self <- summary(ma_res_decided_Self)
decided_Self <- get_metatab(decided_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided_Self <- heterogeneity(ma_obj = ma_res_decided_Self)
var_arti <- (heterogeneity(ma_het_decided_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
indecision_Self <- cbind(decided_Self, var_arti)%>% as.data.frame(.)
```

## Career-related distress

```{r}
# Career-related distress
db_Distress <- db %>% filter(., CRITERION_b == 'Career-related distress') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distressoverall <- cbind(distress, var_arti)%>% as.data.frame(.)


db_distress_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Career-related distress")) 
ma_res_distress_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Env)
distress_out_ic_Env <- summary(ma_res_distress_Env)
distress_Env <- get_metatab(distress_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Env <- heterogeneity(ma_obj = ma_res_distress_Env)
var_arti <- (heterogeneity(ma_het_distress_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distressoverall_Env <- cbind(distress_Env, var_arti)%>% as.data.frame(.)

db_distress_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Career-related distress")) 
ma_res_distress_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Self)
distress_out_ic_Self <- summary(ma_res_distress_Self)
distress_Self <- get_metatab(distress_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Self <- heterogeneity(ma_obj = ma_res_distress_Self)
var_arti <- (heterogeneity(ma_het_distress_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distressoverall_Self <- cbind(distress_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# self-doubts
db_Distress <- db %>% filter(., CRITERION_f == 'Career self-doubt') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_doubt <- cbind(distress, var_arti)%>% as.data.frame(.)

```


```{r}
#Commitment Anxiety
db_Distress <- db %>% filter(., CRITERION_f == 'Commitment Anxiety') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_commit <- cbind(distress, var_arti)%>% as.data.frame(.)


db_distress_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Commitment Anxiety")) 
ma_res_distress_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Env)
distress_out_ic_Env <- summary(ma_res_distress_Env)
distress_Env <- get_metatab(distress_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Env <- heterogeneity(ma_obj = ma_res_distress_Env)
var_arti <- (heterogeneity(ma_het_distress_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_commit_Env <- cbind(distress_Env, var_arti)%>% as.data.frame(.)

db_distress_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Commitment Anxiety")) 
ma_res_distress_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Self)
distress_out_ic_Self <- summary(ma_res_distress_Self)
distress_Self <- get_metatab(distress_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Self <- heterogeneity(ma_obj = ma_res_distress_Self)
var_arti <- (heterogeneity(ma_het_distress_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_commit_Self <- cbind(distress_Self, var_arti)%>% as.data.frame(.)
```

```{r}
#Decision Making Confusion
db_Distress <- db %>% filter(., CRITERION_f == 'Decision making confusion') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_confus <- cbind(distress, var_arti)%>% as.data.frame(.)


db_distress_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Decision making confusion")) 
ma_res_distress_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Env)
distress_out_ic_Env <- summary(ma_res_distress_Env)
distress_Env <- get_metatab(distress_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Env <- heterogeneity(ma_obj = ma_res_distress_Env)
var_arti <- (heterogeneity(ma_het_distress_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_confus_Env <- cbind(distress_Env, var_arti)%>% as.data.frame(.)

db_distress_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Decision making confusion")) 
ma_res_distress_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons_f,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Self)
distress_out_ic_Self <- summary(ma_res_distress_Self)
distress_Self <- get_metatab(distress_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Self <- heterogeneity(ma_obj = ma_res_distress_Self)
var_arti <- (heterogeneity(ma_het_distress_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_confus_Self <- cbind(distress_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# Decisional distress
db_Distress <- db %>% filter(., CRITERION_f == 'Decisional distress') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_decision <- cbind(distress, var_arti)%>% as.data.frame(.)


db_distress_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_f == "Decisional distress")) 
ma_res_distress_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Env)
distress_out_ic_Env <- summary(ma_res_distress_Env)
distress_Env <- get_metatab(distress_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Env <- heterogeneity(ma_obj = ma_res_distress_Env)
var_arti <- (heterogeneity(ma_het_distress_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_decision_Env <- cbind(distress_Env, var_arti)%>% as.data.frame(.)

db_distress_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_f == "Decisional distress")) 
ma_res_distress_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_f",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_distress_Self)
distress_out_ic_Self <- summary(ma_res_distress_Self)
distress_Self <- get_metatab(distress_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress_Self <- heterogeneity(ma_obj = ma_res_distress_Self)
var_arti <- (heterogeneity(ma_het_distress_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distress_decision_Self <- cbind(distress_Self, var_arti)%>% as.data.frame(.)
```

## Employability

```{r}
# Career success
db_success <- db %>% filter(., CRITERION_b == 'Employability') 
ma_res_success <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_success)
success_out_ic <- summary(ma_res_success)
success <- get_metatab(success_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_success <- heterogeneity(ma_obj = ma_res_success)
var_arti <- (heterogeneity(ma_het_success)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
success <- cbind(success, var_arti)%>% as.data.frame(.)

db_success_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Employability")) 
ma_res_success_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_success_Env)
success_out_ic_Env <- summary(ma_res_success_Env)
success_Env <- get_metatab(success_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

ma_het_success_Env <- heterogeneity(ma_obj = ma_res_success_Env)
var_arti <- (heterogeneity(ma_het_success_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
success_Env <- cbind(success_Env, var_arti)%>% as.data.frame(.)

db_success_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Employability")) 
ma_res_success_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_success_Self)
success_out_ic_Self <- summary(ma_res_success_Self)
success_Self <- get_metatab(success_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_success_Self <- heterogeneity(ma_obj = ma_res_success_Self)
var_arti <- (heterogeneity(ma_het_success_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
success_Self <- cbind(success_Self, var_arti)%>% as.data.frame(.)
```

## Demographics 

```{r}
# Age
db_age <- db %>% filter(., CRITERION_b == 'Age') 
ma_res_age <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_age)
age_out_ic <- summary(ma_res_age)
age <- get_metatab(age_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_age <- heterogeneity(ma_obj = ma_res_age)
var_arti <- (heterogeneity(ma_het_age)$heterogeneity)$`analysis id: 1`$barebones$cor
age <- cbind(age, var_arti)%>% as.data.frame(.)

db_age_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Age")) 
ma_res_age_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_age_Env)
age_out_ic_Env <- summary(ma_res_age_Env)
age_Env <- get_metatab(age_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_age_Env <- heterogeneity(ma_obj = ma_res_age_Env)
var_arti <- (heterogeneity(ma_het_age_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
age_Env <- cbind(age_Env, var_arti)%>% as.data.frame(.)

db_age_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Age")) 
ma_res_age_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_age_Self)
age_out_ic_Self <- summary(ma_res_age_Self)
age_Self <- get_metatab(age_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_age_Self <- heterogeneity(ma_obj = ma_res_age_Self)
var_arti <- (heterogeneity(ma_het_age_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
age_Self <- cbind(age_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# Gender
db_Gender <- db %>% filter(., CRITERION_b == 'Gender') 
ma_res_gender <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Gender)
gender_out_ic <- summary(ma_res_gender)
gender <- get_metatab(gender_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_gender <- heterogeneity(ma_obj = ma_res_gender)
var_arti <- (heterogeneity(ma_het_gender)$heterogeneity)$`analysis id: 1`$barebones$cor
gender <- cbind(gender, var_arti)%>% as.data.frame(.)

db_gender_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "Gender")) 
ma_res_gender_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_gender_Env)
gender_out_ic_Env <- summary(ma_res_gender_Env)
gender_Env <- get_metatab(gender_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_gender_Env <- heterogeneity(ma_obj = ma_res_gender_Env)
var_arti <- (heterogeneity(ma_het_gender_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
gender_Env <- cbind(gender_Env, var_arti)%>% as.data.frame(.)

db_gender_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "Gender")) 
ma_res_gender_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_gender_Self)
gender_out_ic_Self <- summary(ma_res_gender_Self)
gender_Self <- get_metatab(gender_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_gender_Self <- heterogeneity(ma_obj = ma_res_gender_Self)
var_arti <- (heterogeneity(ma_het_gender_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
gender_Self <- cbind(gender_Self, var_arti)%>% as.data.frame(.)
```


```{r}
# SES
db_SES <- db %>% filter(., CRITERION_b == 'SES') 
ma_res_SES <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_SES)
SES_out_ic <- summary(ma_res_SES)
SES <- get_metatab(SES_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_SES <- heterogeneity(ma_obj = ma_res_SES)
var_arti <- (heterogeneity(ma_het_SES)$heterogeneity)$`analysis id: 1`$barebones$cor
SES <- cbind(SES, var_arti)%>% as.data.frame(.)

db_SES_Env <- db %>% filter(., (Scales_used == 'Env' & CRITERION_b == "SES")) 
ma_res_SES_Env <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_SES_Env)
SES_out_ic_Env <- summary(ma_res_SES_Env)
SES_Env <- get_metatab(SES_out_ic_Env)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_SES_Env <- heterogeneity(ma_obj = ma_res_SES_Env)
var_arti <- (heterogeneity(ma_het_SES_Env)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
SES_Env <- cbind(SES_Env, var_arti)%>% as.data.frame(.)

db_SES_Self <- db %>% filter(., (Scales_used == 'Self' & CRITERION_b == "SES")) 
ma_res_SES_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_SES_Self)
SES_out_ic_Self <- summary(ma_res_SES_Self)
SES_Self <- get_metatab(SES_out_ic_Self)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_SES_Self <- heterogeneity(ma_obj = ma_res_SES_Self)
var_arti <- (heterogeneity(ma_het_SES_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
SES_Self <- cbind(SES_Self, var_arti)%>% as.data.frame(.)
```

## Make table

```{r}
## Make table
round_df <- function(x, digits) {
    numeric_columns <- sapply(x, mode) == 'numeric'
    x[numeric_columns] <-  round(x[numeric_columns], digits)
    x
}

pvalr <- function(pvals, sig.limit = .001, digits = 2, html = FALSE) {

  roundr <- function(x, digits = 1) {
    res <- sprintf(paste0('%.', digits, 'f'), x)
    zzz <- paste0('0.', paste(rep('0', digits), collapse = ''))
    res[res == paste0('-', zzz)] <- zzz
    res
  }

  sapply(pvals, function(x, sig.limit) {
    if (x < sig.limit)
      if (html)
        return(sprintf('&lt; %s', format(sig.limit))) else
          return(sprintf('< %s', format(sig.limit)))
    if (x > .1)
      return(roundr(x, digits = 2)) else
        return(roundr(x, digits = digits))
  }, sig.limit = sig.limit)
}

roundr <- function(x, digits = 2) {
    res <- sprintf(paste0('%.', digits, 'f'), x)
    zzz <- paste0('0.', paste(rep('0', digits), collapse = ''))
    res[res == paste0('-', zzz)] <- zzz
    res
  }

# Antecedent variables  

out_table_bivariate <- rbind(CESE, CESE_Env, CESE_Self, expectoverall, expectoverall_Env, expectoverall_Self, goals, Goals_Env, Goals_Self, open, open_Env, open_Self, consc, consc_Env, consc_Self, extra, extra_Env, extra_Self, neuro, neuro_Env, neuro_Self, agree, agree_Env, agree_Self, supportoverall, supportoverall_Env, supportoverall_Self, barriersoverall, barriersoverall_Self, barriersoverall_Env)
out_table_bivariate$CI_LL_95[out_table_bivariate$CI_LL_9 < -1] <- -1.00
out_table_bivariate$CR_LL_80[out_table_bivariate$CR_LL_8 < -1] <- -1.00
out_table_bivariate$CI_UL_95[out_table_bivariate$CI_UL_95 > 1] <- 1.00
out_table_bivariate$CR_UL_80[out_table_bivariate$CR_UL_80 > 1] <- 1.00

names <- c("\\multirow{2}{*}{\\shortstack[l]{Self-efficacy for career\\\\hspace{0.8em}exploration and \\\\hspace{0.8em}decision-making}}","", "",
           
           "\\multirow{2}{*}{\\shortstack[l]{Outcome expectations\\\\hspace{0.8em}for career exploration}}", "", "",
           
           "\\multirow{2}{*}{\\shortstack[l]{Career-exploratory\\\\hspace{0.8em}goals}}", "", "", 
           
           "Openness", "", "", 
           "Conscientiousness", "", "", 
           "Extraversion", "", "", 
           "Neuroticism", "", "",
           "Agreeableness", "", "",
           "\\multirow{2}{*}{\\shortstack[l]{Career-related social\\\\hspace{0.8em}support}}", "", "",
           "\\multirow{2}{*}{\\shortstack[l]{Career-related\\\\hspace{0.8em}barriers}}", "", "")


CE_dimension <- c(rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 10))

out_table_bivariate <- cbind(names, CE_dimension, out_table_bivariate) 
out_table_bivariate_ants <- cbind(names, CE_dimension, out_table_bivariate) 


out_table_bivariate$N <- formatC(out_table_bivariate$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$CI_LL_95 <- formatC(out_table_bivariate$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CI_UL_95 <- formatC(out_table_bivariate$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_LL_80 <- formatC(out_table_bivariate$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_UL_80 <- formatC(out_table_bivariate$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)


out_table_bivariate$CI95 <- (paste(out_table_bivariate$CI_LL_95, ", ",out_table_bivariate$CI_UL_95, sep=""))
out_table_bivariate$CR80 <- (paste(out_table_bivariate$CR_LL_80, ", ",out_table_bivariate$CR_UL_80, sep=""))


out_table_bivariate <- out_table_bivariate %>% select(names,CE_dimension, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80, var_arti) %>% as.data.frame(.)

out_table_bivariate$k <- formatC(out_table_bivariate$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$mean_r <- formatC(out_table_bivariate$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$mean_rho <- formatC(out_table_bivariate$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$sd_r_c <- formatC(out_table_bivariate$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
out_table_bivariate$var_arti <- formatC(out_table_bivariate$var_arti, big.mark = ",", format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
library(xtable)


colnames(out_table_bivariate) <- c("Antecedent variable", "Career exploration dimension", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR","cor(\\textit{r}, \\textit{a}) ")
print(xtable(out_table_bivariate, type = "latex"), file = "outputs/out_table_bivariate_antecedents.tex", include.rownames = F , sanitize.text.function = force) 


# Outcome variables

decided <- as.data.frame(decided)
decided_Env <- as.data.frame(decided_Env)
decided_Self <- as.data.frame(decided_Self)
distress <- as.data.frame(distress)
distress_Env <- as.data.frame(distress_Env)
distress_Self <- as.data.frame(distress_Self)
decided_Env <- as.data.frame(decided_Env)

out_table_bivariate <- rbind(decidedoverall, decidedoverall_Env, decidedoverall_Self, distressoverall, distressoverall_Env, distressoverall_Self, success, success_Env, success_Self)  %>% as.data.frame(.)
out_table_bivariate$CI_LL_95[out_table_bivariate$CI_LL_9 < -1] <- -1.00
out_table_bivariate$CR_LL_80[out_table_bivariate$CR_LL_8 < -1] <- -1.00
out_table_bivariate$CI_UL_95[out_table_bivariate$CI_UL_95 > 1] <- 1.00
out_table_bivariate$CR_UL_80[out_table_bivariate$CR_UL_80 > 1] <- 1.00

names <- c("\\multirow{2}{*}{\\shortstack[l]{Career decidedness\\\\hspace{0.8em}and decision-making\\\\hspace{0.8em}difficulties (\\textit{reverse})}}",  "",  "", "Decisional distress", "", "", "Employability", "", "")

CE_dimension <- rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 3)

out_table_bivariate <- cbind(names, CE_dimension, out_table_bivariate) 
out_table_bivariate_out <- cbind(names, CE_dimension, out_table_bivariate) 


out_table_bivariate$N <- formatC(out_table_bivariate$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$CI_LL_95 <- formatC(out_table_bivariate$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CI_UL_95 <- formatC(out_table_bivariate$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_LL_80 <- formatC(out_table_bivariate$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_UL_80 <- formatC(out_table_bivariate$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)


out_table_bivariate$CI95 <- (paste(out_table_bivariate$CI_LL_95, ", ",out_table_bivariate$CI_UL_95, sep=""))
out_table_bivariate$CR80 <- (paste(out_table_bivariate$CR_LL_80, ", ",out_table_bivariate$CR_UL_80, sep=""))


out_table_bivariate <- out_table_bivariate %>% select(names,CE_dimension, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80, var_arti) %>% as.data.frame(.)

out_table_bivariate$k <- formatC(out_table_bivariate$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$mean_r <- formatC(out_table_bivariate$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2)%>% gsub("0\\.", "\\.", .)
out_table_bivariate$mean_rho <- formatC(out_table_bivariate$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$sd_r_c <- formatC(out_table_bivariate$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
out_table_bivariate$var_arti <- formatC(out_table_bivariate$var_arti, big.mark = ",", format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
library(xtable)


colnames(out_table_bivariate) <- c("Antecedent variable", "Career exploration dimension", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR","cor(\\textit{r}, \\textit{a}) ")
print(xtable(out_table_bivariate, type = "latex"), file = "outputs/out_table_bivariate_outcomes.tex", include.rownames = F , sanitize.text.function = force) 


# Demographic variables  
out_table_bivariate <- rbind(age, age_Env, age_Self, gender,  gender_Env, gender_Self, SES, SES_Env, SES_Self)  %>% as.data.frame(.)
out_table_bivariate$CI_LL_95[out_table_bivariate$CI_LL_9 < -1] <- -1.00
out_table_bivariate$CR_LL_80[out_table_bivariate$CR_LL_8 < -1] <- -1.00
out_table_bivariate$CI_UL_95[out_table_bivariate$CI_UL_95 > 1] <- 1.00
out_table_bivariate$CR_UL_80[out_table_bivariate$CR_UL_80 > 1] <- 1.00

names <- c("Age", "", "", "Gender", "", "", "Socioeconomic status", "", "")

CE_dimension <- rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 3)

out_table_bivariate <- cbind(names, CE_dimension, out_table_bivariate) 
out_table_bivariate_demos <- cbind(names, CE_dimension, out_table_bivariate) 


out_table_bivariate$N <- formatC(out_table_bivariate$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$CI_LL_95 <- formatC(out_table_bivariate$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CI_UL_95 <- formatC(out_table_bivariate$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_LL_80 <- formatC(out_table_bivariate$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_UL_80 <- formatC(out_table_bivariate$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2)%>% gsub("0\\.", "\\.", .)


out_table_bivariate$CI95 <- (paste(out_table_bivariate$CI_LL_95, ", ",out_table_bivariate$CI_UL_95, sep=""))
out_table_bivariate$CR80 <- (paste(out_table_bivariate$CR_LL_80, ", ",out_table_bivariate$CR_UL_80, sep=""))


out_table_bivariate <- out_table_bivariate %>% select(names,CE_dimension, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80, var_arti) %>% as.data.frame(.)

out_table_bivariate$k <- formatC(out_table_bivariate$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$mean_r <- formatC(out_table_bivariate$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$mean_rho <- formatC(out_table_bivariate$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$sd_r_c <- formatC(out_table_bivariate$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
out_table_bivariate$var_arti <- formatC(out_table_bivariate$var_arti, big.mark = ",", format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
library(xtable)


colnames(out_table_bivariate) <- c("Antecedent variable", "Career exploration dimension", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR","cor(\\textit{r}, \\textit{a}) ")
print(xtable(out_table_bivariate, type = "latex"), file = "outputs/out_table_bivariate_demos.tex", include.rownames = F , sanitize.text.function = force) 

# make rho and k rows in latex
out_table_bivariate_all <- rbind(out_table_bivariate_ants, out_table_bivariate_out, out_table_bivariate_demos) 
out_table_bivariate_all <- out_table_bivariate_all[,-c(1,2)]
mean_df <- out_table_bivariate_all 
mean_df$names <- c(rep("CRSE", 3), rep("Expectations", 3), rep("Goals", 3), rep("Open", 3), rep("Consc", 3), rep("Extra", 3), rep("Neuro", 3), rep("Agree", 3), rep("Sup", 3),rep("Bar", 3),  rep("Decid", 3), rep("Distress", 3), rep("Success", 3), rep("Age", 3), rep("Gender", 3), rep("SES", 3))

mean_df$names <- paste0(mean_df$names, rep(c("", "Env", "Self"), 16))

mean_rho <- paste0("\\newcommand\\", "rho", mean_df$names, "{", round(mean_df$mean_rho, 2), "}")
mean_Rho<-file("outputs/mean_rho.txt")
writeLines(mean_rho, mean_Rho)
close(mean_Rho)

k <- paste0("\\newcommand\\", "k", mean_df$names, "{", mean_df$k, "}")
K_file<-file("outputs/k.txt")
writeLines(k, K_file)
close(K_file)

```

## Make FULL table APPENDIX 

```{r}
# Antecedent variables  
out_table_bivariate <- rbind(CESE, CESE_Env, CESE_Self, 
                             expectoverall, expectoverall_Env, expectoverall_Self, 
                             env_expect, env_expect_Env, env_expect_Self,
                             self_expect, self_expect_Env, self_expect_Self, 
                             overall_expect, overall_expect_Env, overall_expect_Self, 
                             goals, Goals_Env, Goals_Self, 
                             open, open_Env, open_Self, 
                             consc, consc_Env, consc_Self, 
                             extra, extra_Env, extra_Self, 
                             neuro, neuro_Env, neuro_Self, 
                             agree, agree_Env, agree_Self, 
                             supportoverall, supportoverall_Env, supportoverall_Self,
                             family_support, family_support_Env, family_support_Self, 
                             peer_support,
                             institutional_support, institutional_support_Env, institutional_support_Self, 
                             unspecific_support, 
                             barriersoverall, barriersoverall_Env, barriersoverall_Self,
                             interactional_barriers, 
                             social_barriers, social_barriers_Env, social_barriers_Self, 
                             overall_barriers) 
out_table_bivariate$CI_LL_95[out_table_bivariate$CI_LL_9 < -1] <- -1.00
out_table_bivariate$CR_LL_80[out_table_bivariate$CR_LL_8 < -1] <- -1.00
out_table_bivariate$CI_UL_95[out_table_bivariate$CI_UL_95 > 1] <- 1.00
out_table_bivariate$CR_UL_80[out_table_bivariate$CR_UL_80 > 1] <- 1.00
```


```{r}
names <- c(
  "\\multirow{2}{*}{\\shortstack[l]{Self-efficacy for career\\\\hspace{0.8em}exploration and \\\\hspace{0.8em}decision-making}}","", "",
  
  "\\multirow{2}{*}{\\shortstack[l]{Outcome expectations\\\\hspace{0.8em}for career exploration}}", "", "",
  "\\multirow{2}{*}{\\shortstack[l]{\\hspace{0.8em}Outcome expectations\\\\hspace{0.8em}for environment\\\\hspace{0.8em}exploration}}", "", "",
   "\\multirow{2}{*}{\\shortstack[l]{\\hspace{0.8em}Outcome expectations\\\\hspace{0.8em}for self-exploration}}", "", "",
   "\\multirow{2}{*}{\\shortstack[l]{\\hspace{0.8em}Overall outcome\\\\hspace{0.8em}expectations}}", "", "",
  
  "\\multirow{2}{*}{\\shortstack[l]{Career-exploratory\\\\hspace{0.8em}goals}}", "", "", 
  
  "Openness", "", "", 
  "Conscientiousness", "", "", 
  "Extraversion", "", "", 
  "Neuroticism", "", "",
  "Agreeableness", "", "",
  
  "\\multirow{2}{*}{\\shortstack[l]{Career-related social\\\\hspace{0.8em}support}}", "", "",
  "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Family support}}", "", "",
  "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Peer support}}",
  "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Institutional support}}", "", "",
   "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Unspecific support}}", 
  
  "\\multirow{2}{*}{\\shortstack[l]{Career-related\\\\hspace{0.8em}barriers}}","","",
   "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Interactional barriers}}",
   "\\multirow{2}{*}{\\shortstack[l]{\\hspace{0.8em}Social-interpersonal\\\\hspace{0.8em}barriers}}","","",
  "\\multirow{1}{*}{\\shortstack[l]{\\hspace{0.8em}Overall barriers}}")


CE_dimension <- c(rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 13), 
                  "Career exploration", 
                  "Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration", 
                  "Career exploration", 
                  "Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration", 
                  "Career exploration", 
                  "Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration", 
                  "Career exploration")

out_table_bivariate <- cbind(names, CE_dimension, out_table_bivariate) 
out_table_bivariate_ants <- cbind(names, CE_dimension, out_table_bivariate) 


out_table_bivariate$N <- formatC(out_table_bivariate$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$CI_LL_95 <- formatC(out_table_bivariate$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CI_UL_95 <- formatC(out_table_bivariate$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_LL_80 <- formatC(out_table_bivariate$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_UL_80 <- formatC(out_table_bivariate$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)


out_table_bivariate$CI95 <- (paste(out_table_bivariate$CI_LL_95, ", ",out_table_bivariate$CI_UL_95, sep=""))
out_table_bivariate$CR80 <- (paste(out_table_bivariate$CR_LL_80, ", ",out_table_bivariate$CR_UL_80, sep=""))


out_table_bivariate <- out_table_bivariate %>% select(names,CE_dimension, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80, var_arti) %>% as.data.frame(.)

out_table_bivariate$k <- formatC(out_table_bivariate$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$mean_r <- formatC(out_table_bivariate$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$mean_rho <- formatC(out_table_bivariate$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$sd_r_c <- formatC(out_table_bivariate$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
out_table_bivariate$var_arti <- formatC(out_table_bivariate$var_arti, big.mark = ",", format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
library(xtable)

colnames(out_table_bivariate) <- c("Antecedent variable", "Career exploration dimension", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR","cor(\\textit{r}, \\textit{a}) ")
print(xtable(out_table_bivariate, type = "latex"), file = "outputs/out_table_bivariate_antecedents_subcategories.tex", include.rownames = F , sanitize.text.function = force) 

str(distress)
decided <- as.data.frame(decided)
decided_Env <- as.data.frame(decided_Env)
decided_Self <- as.data.frame(decided_Self)
distress <- as.data.frame(distress)
distress_Env <- as.data.frame(distress_Env)
distress_Self <- as.data.frame(distress_Self)
decided_Env <- as.data.frame(decided_Env)
# Outcome variables  
out_table_bivariate <- rbind(decidedoverall, decidedoverall_Env, decidedoverall_Self, decidedness, decidedness_Env, decidedness_Self, indecision, indecision_Env, indecision_Self, distressoverall, distressoverall_Env, distressoverall_Self, distress_doubt, distress_commit, distress_commit_Env, distress_commit_Self, distress_confus, distress_confus_Env, distress_confus_Self, distress_decision, distress_decision_Env, distress_decision_Self, success, success_Env, success_Self)  %>% as.data.frame(.)

out_table_bivariate$CI_LL_95[out_table_bivariate$CI_LL_9 < -1] <- -1.00
out_table_bivariate$CR_LL_80[out_table_bivariate$CR_LL_8 < -1] <- -1.00
out_table_bivariate$CI_UL_95[out_table_bivariate$CI_UL_95 > 1] <- 1.00
out_table_bivariate$CR_UL_80[out_table_bivariate$CR_UL_80 > 1] <- 1.00

names <- c("\\multirow{2}{*}{\\shortstack[l]{Career decidedness\\\\hspace{0.8em}and decision-making\\\\hspace{0.8em}difficulties (\\textit{reverse})}}",  "",  "", 
           "Career decidedness", "", "",
           "\\multirow{2}{*}{\\shortstack[l]{Decision-making\\\\hspace{0.8em}difficulties}}",  "",  "",
           "Decisional distress", "", "",
           "Career self-doubt", 
           "Commitment anxiety", "", "",
           "\\multirow{2}{*}{\\shortstack[l]{Decision-making\\\\hspace{0.8em}confusion}}",  "",  "",
           "Decisional stress", "", "",
           "Employability", "", "")

CE_dimension <- c(rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 4), 
                    "Career exploration", 
                    rep(c("Career exploration", "\\hspace{0.8em}Env. exploration", "\\hspace{0.8em}Self-exploration"), 4))

out_table_bivariate <- cbind(names, CE_dimension, out_table_bivariate) 
out_table_bivariate_out <- cbind(names, CE_dimension, out_table_bivariate) 


out_table_bivariate$N <- formatC(out_table_bivariate$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$CI_LL_95 <- formatC(out_table_bivariate$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CI_UL_95 <- formatC(out_table_bivariate$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_LL_80 <- formatC(out_table_bivariate$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$CR_UL_80 <- formatC(out_table_bivariate$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)


out_table_bivariate$CI95 <- (paste(out_table_bivariate$CI_LL_95, ", ",out_table_bivariate$CI_UL_95, sep=""))
out_table_bivariate$CR80 <- (paste(out_table_bivariate$CR_LL_80, ", ",out_table_bivariate$CR_UL_80, sep=""))


out_table_bivariate <- out_table_bivariate %>% select(names,CE_dimension, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80, var_arti) %>% as.data.frame(.)

out_table_bivariate$k <- formatC(out_table_bivariate$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
out_table_bivariate$mean_r <- formatC(out_table_bivariate$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2)%>% gsub("0\\.", "\\.", .)
out_table_bivariate$mean_rho <- formatC(out_table_bivariate$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
out_table_bivariate$sd_r_c <- formatC(out_table_bivariate$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
out_table_bivariate$var_arti <- formatC(out_table_bivariate$var_arti, big.mark = ",", format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
library(xtable)
colnames(out_table_bivariate) <- c("Outcome variable", "Career exploration dimension", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR","cor(\\textit{r}, \\textit{a}) ")
print(xtable(out_table_bivariate, type = "latex"), file = "outputs/out_table_bivariate_outcomes_subcategories.tex", include.rownames = F , sanitize.text.function = force) 


```

# Relationship between environment and self-exploration
```{r}
db_Env_Self <- db %>% filter(., (Criterion == 'ENV' & Scales_used == "Self")) 
ma_res_Env_Self <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Scales_used",
                    construct_y = "Criterion",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    #intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Env_Self)
CE_out_ic <- summary(ma_res_Env_Self)
Env_Self <- get_metatab(CE_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_Env_Self <- heterogeneity(ma_obj = ma_res_Env_Self)
var_arti <- (heterogeneity(ma_res_Env_Self)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
Env_Self_1 <- (cbind(Env_Self, var_arti)) %>% round_df(2)
Env_Self_1$N <- formatC(Env_Self_1$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 

Env_Self <- Map(paste0, "\\newcommand\\", "EnvSelf", names(Env_Self_1), "{", Env_Self_1,"}") %>% sub("_", "", .)   %>% sub("_", "", .) %>% { ifelse(is.na(.), NA, sapply(., toString)) }

Env_Self_file<-file("outputs/Env_Self.txt")
writeLines(Env_Self, Env_Self_file)
close(Env_Self_file)

```


# Sensitivity analyses

```{r}
# CSE

db_CESE <- db %>% filter(., CRITERION_b == 'Career-related self-efficacy') 
ma_res_CESE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_CESE)
CESE_out_ic <- summary(ma_res_CESE)
get_escalc(ma_res_CESE)$`analysis_id: 1`$individual_correction$true_score
CESE <- get_metatab(CESE_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_CESE <- heterogeneity(ma_obj = ma_res_CESE)
var_arti <- (heterogeneity(ma_het_CESE)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
CESE <- cbind(CESE, var_arti)

ma_obj <- sensitivity(ma_res_CESE,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_CESE <- out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_CESE.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_CESE
dev.off()


# Outcome expectations 
db_expect <- db %>% filter(., CRITERION_b == "Outcome expectations") 
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect)
expect <- get_metatab(expect_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80, sd_r_c)
ma_het_expect <- heterogeneity(ma_obj = ma_res_expect)
var_arti <- (heterogeneity(ma_het_expect)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
expectoverall <- as.data.frame(cbind(expect, var_arti))

ma_obj <- sensitivity(ma_res_expect,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_expect <- out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]
out_cumutab_expect <- out_cumulative$`analysis id: 1`$individual_correction$true_score

pdf(file = "outputs/cumulative_plot_expect.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_expect
dev.off()


# career exploratory goals 
db_Goals <- db %>% filter(., CRITERION_b == 'Career engagement goals') 
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Goals)
goals_out_ic <- summary(ma_res_goals)
goals <- get_metatab(goals_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_goals <- heterogeneity(ma_obj = ma_res_goals)
var_arti <- (heterogeneity(ma_het_goals)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
goals <- cbind(goals, var_arti)

ma_obj <- sensitivity(ma_res_goals,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_goals <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]
out_cumutab_goals <- out_cumulative$`analysis id: 1`$individual_correction$true_score



pdf(file = "outputs/cumulative_plot_goals.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_goals
dev.off()

# Personality 
ma_obj <- sensitivity(ma_res_open,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_open <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_open.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_open
dev.off()

ma_obj <- sensitivity(ma_res_consc,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_consc <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_consc.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_consc
dev.off()

ma_obj <- sensitivity(ma_res_extra,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_extra <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_extra.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_extra
dev.off()

ma_obj <- sensitivity(ma_res_neuro,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_neuro <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]
out_cumutab_neuro <- out_cumulative$`analysis id: 1`$individual_correction$true_score


pdf(file = "outputs/cumulative_plot_neuro.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_neuro
dev.off()

ma_obj <- sensitivity(ma_res_agree,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_agree <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_agree.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_agree
dev.off()

# Support

db_Support <- db %>% filter(., CRITERION_b == 'Career-related social support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Support)
support_out_ic <- summary(ma_res_support)
support <- get_metatab(support_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_support <- heterogeneity(ma_obj = ma_res_support)
var_arti <- (heterogeneity(ma_het_support)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
supportoverall <- as.data.frame(cbind(support, var_arti))

ma_obj <- sensitivity(ma_res_support,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_support <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_support.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_support
dev.off()

# Barriers
db_Barriers <- db %>% filter(., CRITERION_b == 'Barriers') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Barriers)
barriers_out_ic <- summary(ma_res_barriers)
barriers <- get_metatab(barriers_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_barriers <- heterogeneity(ma_obj = ma_res_barriers)
var_arti <- (heterogeneity(ma_het_barriers)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
barriersoverall <- cbind(barriers, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_barriers,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_barriers <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_barriers.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_barriers
dev.off()

# Career decidedness
db_Decided <- db %>% filter(., CRITERION_b == 'Career decidedness') 

ma_res_decided <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = db_Decided)
decided_out_ic <- summary(ma_res_decided)
decided <- get_metatab(decided_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_decided <- heterogeneity(ma_obj = ma_res_decided)
var_arti <- (heterogeneity(ma_res_decided)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
decidedoverall <- cbind(decided, var_arti) %>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_decided,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_decided <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_decided.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_decided
dev.off()

# Career-related distress
db_Distress <- db %>% filter(., CRITERION_b == 'Career-related distress') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Distress)
distress_out_ic <- summary(ma_res_distress)
distress <- get_metatab(distress_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_distress <- heterogeneity(ma_obj = ma_res_distress)
var_arti <- (heterogeneity(ma_het_distress)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
distressoverall <- cbind(distress, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_distress,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_distress <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]
out_cumutab_distress <- out_cumulative$`analysis id: 1`$individual_correction$true_score
cum_distress <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]




pdf(file = "outputs/cumulative_plot_distress.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_distress
dev.off()

# Employability
db_success <- db %>% filter(., CRITERION_b == 'Employability') 
ma_res_success <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_success)
success_out_ic <- summary(ma_res_success)
success <- get_metatab(success_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_success <- heterogeneity(ma_obj = ma_res_success)
var_arti <- (heterogeneity(ma_het_success)$heterogeneity)$`analysis id: 1`$individual_correction$true_score$cor
success <- cbind(success, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_success,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_success <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_success.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_success
dev.off()

# Age
db_age <- db %>% filter(., CRITERION_b == 'Age') 
ma_res_age <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_age)
age_out_ic <- summary(ma_res_age)
age <- get_metatab(age_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_age <- heterogeneity(ma_obj = ma_res_age)
var_arti <- (heterogeneity(ma_het_age)$heterogeneity)$`analysis id: 1`$barebones$cor
age <- cbind(age, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_age,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_age <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_age.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_age
dev.off()

# Gender
db_Gender <- db %>% filter(., CRITERION_b == 'Gender') 
ma_res_gender <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_Gender)
gender_out_ic <- summary(ma_res_gender)
gender <- get_metatab(gender_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_gender <- heterogeneity(ma_obj = ma_res_gender)
var_arti <- (heterogeneity(ma_het_gender)$heterogeneity)$`analysis id: 1`$barebones$cor
gender <- cbind(gender, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_gender,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_gender <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_gender.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_gender
dev.off()

# SES
db_SES <- db %>% filter(., CRITERION_b == 'SES') 
ma_res_SES <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = FALSE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    data = db_SES)
SES_out_ic <- summary(ma_res_SES)
SES <- get_metatab(SES_out_ic)$individual_correction$true_score %>% select(k, N, mean_r, mean_rho, sd_r_c, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
ma_het_SES <- heterogeneity(ma_obj = ma_res_SES)
var_arti <- (heterogeneity(ma_het_SES)$heterogeneity)$`analysis id: 1`$barebones$cor
SES <- cbind(SES, var_arti)%>% as.data.frame(.)

ma_obj <- sensitivity(ma_res_SES,
                      leave1out = TRUE,
                      bootstrap = TRUE,
                      cumulative = TRUE,
                      sort_method = "weight",
                      boot_iter = 1000,
                      boot_conf_level = 0.95,
                      boot_ci_type = "norm")
out_cumulative <- get_cumulative(ma_obj)
out_cumulative[[1]]$individual_correction$true_score
out_plots <- get_plots(ma_obj, plot_types = c("leave1out", "cumulative"))
cum_SES <-out_plots$cumulative$`analysis id: 1`$individual_correction$true_score$plots[1]


pdf(file = "outputs/cumulative_plot_SES.pdf",   # The directory you want to save the file in
    width = 4, # The width of the plot in inches
    height = 4) # The height of the plot in inches

cum_SES
dev.off()



```
## Make table
```{r}
# Demographic variables  
cum_outtab <- rbind(out_cumutab_expect$data, out_cumutab_neuro$data)  %>% as.data.frame(.)


cum_outtab$N <- formatC(cum_outtab$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
cum_outtab$CI_LL_95 <- formatC(cum_outtab$CI_LL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
cum_outtab$CI_UL_95 <- formatC(cum_outtab$CI_UL_95, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
cum_outtab$CR_LL_80 <- formatC(cum_outtab$CR_LL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
cum_outtab$CR_UL_80 <- formatC(cum_outtab$CR_UL_80, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)


cum_outtab$CI95 <- (paste(cum_outtab$CI_LL_95, ", ",cum_outtab$CI_UL_95, sep=""))
cum_outtab$CR80 <- (paste(cum_outtab$CR_LL_80, ", ",cum_outtab$CR_UL_80, sep=""))


cum_outtab <- cum_outtab %>% select(study_added, k, N, mean_r, mean_rho, sd_r_c, CI95, CR80) %>% as.data.frame(.)

cum_outtab$k <- formatC(cum_outtab$k, big.mark = ",", format = "f", zero.print = T, digits = 0) 
cum_outtab$mean_r <- formatC(cum_outtab$mean_r, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
cum_outtab$mean_rho <- formatC(cum_outtab$mean_rho, big.mark = ",", format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
cum_outtab$sd_r_c <- formatC(cum_outtab$sd_r_c, big.mark = ",", format = "f", zero.print = T, digits = 2) 
library(xtable)


colnames(cum_outtab) <- c("Study added", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "\\textit{$SD_c$}", "95\\% CI", "80\\% CR")
print(xtable(cum_outtab, type = "latex"), file = "outputs/cum_outtab.tex", include.rownames = F , sanitize.text.function = force) 
```


```{r}
CESE_escalc <- get_escalc(ma_res_CESE)[1]$`analysis_id: 1`$individual_correction$true_score
expect_escalc <- get_escalc(ma_res_expect)[1]$`analysis_id: 1`$individual_correction$true_score
goals_escalc <- get_escalc(ma_res_goals)[1]$`analysis_id: 1`$individual_correction$true_score
open_escalc <- get_escalc(ma_res_open)[1]$`analysis_id: 1`$individual_correction$true_score
consc_escalc <- get_escalc(ma_res_consc)[1]$`analysis_id: 1`$individual_correction$true_score
extra_escalc <- get_escalc(ma_res_extra)[1]$`analysis_id: 1`$individual_correction$true_score
neuro_escalc <- get_escalc(ma_res_neuro)[1]$`analysis_id: 1`$individual_correction$true_score
agree_escalc <- get_escalc(ma_res_agree)[1]$`analysis_id: 1`$individual_correction$true_score
support_escalc <- get_escalc(ma_res_support)[1]$`analysis_id: 1`$individual_correction$true_score
barriers_escalc <- get_escalc(ma_res_barriers)[1]$`analysis_id: 1`$individual_correction$true_score
decided_escalc <- get_escalc(ma_res_decided)[1]$`analysis_id: 1`$individual_correction$true_score
distress_escalc <- get_escalc(ma_res_distress)[1]$`analysis_id: 1`$individual_correction$true_score
success_escalc <- get_escalc(ma_res_success)[1]$`analysis_id: 1`$individual_correction$true_score
age_escalc <- get_escalc(ma_res_age)[1]$`analysis_id: 1`$individual_correction$true_score
gender_escalc <- get_escalc(ma_res_gender)[1]$`analysis_id: 1`$individual_correction$true_score
SES_escalc <- get_escalc(ma_res_SES)[1]$`analysis_id: 1`$individual_correction$true_score

```


# Moderator analyses

## Preparation
```{r}
# M_age: continous 
# Prct_female: continous 

# Study Field: Business, 
db$Field <- na_if(db$Field, "NA")
unique(db$Field )

# Country 
unique(db$Country)

# Power Distance, Individualism, Masculinity, Uncertainty, Long_term orientation, Indulgence: continous

# Pblication status 
unique(db$Pub_status)
db$Pub_status_recode <- fct_collapse(db$Pub_status,
                                               Published = c("PUB"),
                                               Unpublished = c("MT", "DT"))

# Publication year: continuous

# Career exploration scale
unique(db$CE_scale)
db$CE_scale_recode <- fct_collapse(db$CE_scale,
                                   Stumpf = c("Stumpf1983", "Taveira1997", "Nasta2007", "Choi2003", "Blustein1988/89", "Xu2008", "Devenis1995", "Teixeira2007", "Adachi2001"),
                                   other = c("Hirschi2009", "Kracke1997", "Lent2014", "Porfeli2011"))

# reference period
db$Reference_period <- na_if(db$Reference_period, "NA")
unique(db$Reference_period)

```

## Moderator analyses

### Career related  self-efficacy

```{r}
library(psychmeta)

# Intercorrelations 
intercor_cons <-  control_intercor(rxyi = Intercor_rxy, n = Intercor_N, sample_id = Intercor_ID, construct_x = Intercor_x, construct_y = Intercor_y, data = intercor)

# M_age
db_CDSE <- db %>% filter(., CRITERION_b == 'Career-related self-efficacy') 
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
CDSE_out_ic <- summary(ma_res_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_age_metareg <- CDSE_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_prctfemale_metareg <- CDSE_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Power_distance <- CDSE_Power_distance[2, ]
# not sign 

# Individualism
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Individualism <- CDSE_Individualism[2, ]
# not sign 

# Masculinity
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Masculinity <- CDSE_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Uncertainty_Avoidance <- CDSE_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Long_Term_Orientation <- CDSE_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Indulgence <- CDSE_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_CDSE)
summary(ma_res_CDSE)
CRSE_anova_pub_stat <- anova(ma_res_CDSE, ma_method = "ic")
CDSE_Pub_status <- get_metatab(ma_res_CDSE)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)


# Pub Year
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_CDSE)
ma_res_CDSE <- metareg(ma_res_CDSE)
get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_CDSE)[[1]]$individual_correction$true_score$Main
CDSE_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
CDSE_Year <- CDSE_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CE_scale_recode", 
                    
                    cat_moderators = TRUE,
                    data = db_CDSE)
summary(ma_res_CDSE)
anova(ma_res_CDSE)
CRSE_anova_ce_scale <- anova(ma_res_CDSE,  ma_method = "ic")

CDSE_CEscale <- get_metatab(ma_res_CDSE)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
CDSE_CEscale <- CDSE_CEscale[-1,]
# not sign

metaregs_CDSE <- rbind(CDSE_age_metareg, CDSE_prctfemale_metareg, CDSE_Power_distance, CDSE_Individualism, CDSE_Masculinity, CDSE_Uncertainty_Avoidance, CDSE_Long_Term_Orientation, CDSE_Indulgence, CDSE_Year) %>% data.frame(.)
colnames(metaregs_CDSE) <- c("Estimate", "SE", "p", "CILB", "CIUB")


CDSE_Pub_status <- rename(CDSE_Pub_status, Moderator = Pub_status_recode)
CDSE_CEscale <- rename(CDSE_CEscale, Moderator = CE_scale_recode)
catmods_CDSE <- rbind(CDSE_Pub_status, CDSE_CEscale)
```


### Outcome expectations

```{r}
library(psychmeta)

# M_age
db_expect <- db %>% filter(., CRITERION_b == 'Outcome expectations') 
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
expect_out_ic <- summary(ma_res_expect)
ma_res_expect <- metareg(ma_res_expect)
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_age_metareg <- expect_age_metareg[2, ]


# not sign 

# Prct_female
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_prctfemale_metareg <- expect_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Power_distance <- expect_Power_distance[2, ]
# not sign 

# Individualism
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Individualism <- expect_Individualism[2, ]
# not sign 

# Masculinity
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Masculinity <- expect_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Uncertainty_Avoidance <- expect_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Long_Term_Orientation <- expect_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Indulgence <- expect_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_expect)
summary(ma_res_expect)

expect_anova_pub_stat <- anova(ma_res_expect,  ma_method = "ic")
expect_Pub_status <- get_metatab(ma_res_expect)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# SCALE
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CRITERION_f", 
                    cat_moderators = TRUE,
                    
                    data = db_expect)
summary(ma_res_expect)

expect_anova_scale <- anova(ma_res_expect,  ma_method = "ic")
expect_scale <- get_metatab(ma_res_expect)$individual_correction$true_score %>% select(construct_x, construct_y, CRITERION_f, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# Pub Year
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_expect)
ma_res_expect <- metareg(ma_res_expect)
get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_expect)[[1]]$individual_correction$true_score$Main
expect_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
expect_Year <- expect_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    moderators = "CE_scale_recode", 
                    cat_moderators = TRUE,
                    data = db_expect)
summary(ma_res_expect)
anova(ma_res_expect)
expect_anova_ce_scale <- anova(ma_res_expect,  ma_method = "ic")
expect_CEscale <- get_metatab(ma_res_expect)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
expect_CEscale <- expect_CEscale[-1,]
# not sig


metaregs_expect <- rbind(expect_age_metareg, expect_prctfemale_metareg, expect_Power_distance, expect_Individualism, expect_Masculinity, expect_Uncertainty_Avoidance, expect_Long_Term_Orientation, expect_Indulgence, expect_Year) %>% data.frame(.)
colnames(metaregs_expect) <- c("Estimate", "SE", "p", "CILB", "CIUB")


expect_Pub_status <- rename(expect_Pub_status, Moderator = Pub_status_recode)
expect_CEscale <- rename(expect_CEscale, Moderator = CE_scale_recode)
expect_scale <- rename(expect_scale, Moderator = CRITERION_f)

catmods_expect <- rbind(expect_Pub_status, expect_CEscale, expect_scale)
```

### Career engagement goals

```{r}
library(psychmeta)

# M_age
db_goals <- db %>% filter(., CRITERION_b == 'Career engagement goals') 
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
goals_out_ic <- summary(ma_res_goals)
ma_res_goals <- metareg(ma_res_goals)
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_age_metareg <- goals_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_prctfemale_metareg <- goals_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Power_distance <- goals_Power_distance[2, ]
# not sign 

# Individualism
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Individualism <- goals_Individualism[2, ]
# not sign 

# Masculinity
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Masculinity <- goals_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Uncertainty_Avoidance <- goals_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Long_Term_Orientation <- goals_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Indulgence <- goals_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_goals)
summary(ma_res_goals)
goals_anova_pub_stat <- anova(ma_res_goals,  ma_method = "ic")

goals_Pub_status <- get_metatab(ma_res_goals)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# Pub Year
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_goals)
ma_res_goals <- metareg(ma_res_goals)
get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_goals)[[1]]$individual_correction$true_score$Main
goals_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
goals_Year <- goals_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_goals <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CE_scale_recode", 
                    cat_moderators = TRUE,
                   
                    data = db_goals)
summary(ma_res_goals)
goals_anova_ce_scale <- anova(ma_res_goals,  ma_method = "ic")
goals_CEscale <- get_metatab(ma_res_goals)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
goals_CEscale <- goals_CEscale[-1,]
# not sign

metaregs_goals <- rbind(goals_age_metareg, goals_prctfemale_metareg, goals_Power_distance, goals_Individualism, goals_Masculinity, goals_Uncertainty_Avoidance, goals_Long_Term_Orientation, goals_Indulgence, goals_Year) %>% data.frame(.)
colnames(metaregs_goals) <- c("Estimate", "SE", "p", "CILB", "CIUB")


goals_Pub_status <- rename(goals_Pub_status, Moderator = Pub_status_recode)
goals_CEscale <- rename(goals_CEscale, Moderator = CE_scale_recode)
catmods_goals <- rbind(goals_Pub_status, goals_CEscale)
```

### Career support

```{r}
library(psychmeta)

# M_age
db_support <- db %>% filter(., CRITERION_b == 'Career-related social support') 
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                    data = db_support)

support_out_ic <- summary(ma_res_support)
ma_res_support <- metareg(ma_res_support)
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_age_metareg <- support_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_prctfemale_metareg <- support_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Power_distance <- support_Power_distance[2, ]
# not sign 

# Individualism
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Individualism <- support_Individualism[2, ]
# not sign 

# Masculinity
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Masculinity <- support_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Uncertainty_Avoidance <- support_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Long_Term_Orientation <- support_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Indulgence <- support_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_support)
summary(ma_res_support)
support_anova_pub_stat <- anova(ma_res_support,  ma_method = "ic")

support_Pub_status <- get_metatab(ma_res_support)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)




# SCALE
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CRITERION_f", 
                    cat_moderators = TRUE,
                    
                    data = db_support)
summary(ma_res_support)
support_anova_scale <- anova(ma_res_support,  ma_method = "ic")

support_scale <- get_metatab(ma_res_support)$individual_correction$true_score %>% select(construct_x, construct_y, CRITERION_f, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
# Pub Year
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_support)
ma_res_support <- metareg(ma_res_support)
get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_support)[[1]]$individual_correction$true_score$Main
support_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
support_Year <- support_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_support <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CE_scale_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_support)
summary(ma_res_support)
support_anova_ce_scale <- anova(ma_res_support,  ma_method = "ic")

support_CEscale <- get_metatab(ma_res_support)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
support_CEscale <- support_CEscale[-1,]
# not sign

metaregs_support <- rbind(support_age_metareg, support_prctfemale_metareg, support_Power_distance, support_Individualism, support_Masculinity, support_Uncertainty_Avoidance, support_Long_Term_Orientation, support_Indulgence, support_Year) %>% data.frame(.)
colnames(metaregs_support) <- c("Estimate", "SE", "p", "CILB", "CIUB")


support_Pub_status <- rename(support_Pub_status, Moderator = Pub_status_recode)
support_CEscale <- rename(support_CEscale, Moderator = CE_scale_recode)
support_scale <- rename(support_scale, Moderator = CRITERION_f)

catmods_support <- rbind(support_Pub_status, support_CEscale, support_scale)
```

### Career barriers

```{r}
library(psychmeta)

# M_age
db_barriers <- db %>% filter(., CRITERION_b == 'Barriers') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
barriers_out_ic <- summary(ma_res_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_age_metareg <- barriers_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_prctfemale_metareg <- barriers_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                   
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Power_distance <- barriers_Power_distance[2, ]
# not sign 

# Individualism
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Individualism <- barriers_Individualism[2, ]
# not sign 

# Masculinity
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Masculinity <- barriers_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Uncertainty_Avoidance <- barriers_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Long_Term_Orientation <- barriers_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                   
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Indulgence <- barriers_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_barriers)
summary(ma_res_barriers)
barriers_anova_pub_stat <- anova(ma_res_barriers,  ma_method = "ic")

barriers_Pub_status <- get_metatab(ma_res_barriers)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# SCALE
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CRITERION_f", 
                    cat_moderators = TRUE,
                    
                    data = db_barriers)
summary(ma_res_barriers)
barriers_anova_scale <- anova(ma_res_barriers,  ma_method = "ic")

barriers_scale <- get_metatab(ma_res_barriers)$individual_correction$true_score %>% select(construct_x, construct_y, CRITERION_f, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# Pub Year
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_barriers)
ma_res_barriers <- metareg(ma_res_barriers)
get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_barriers)[[1]]$individual_correction$true_score$Main
barriers_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
barriers_Year <- barriers_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    moderators = "CE_scale_recode", 
                    cat_moderators = TRUE,
                    data = db_barriers)
summary(ma_res_barriers)
barriers_anova_ce_scale <- anova(ma_res_barriers,  ma_method = "ic")
barriers_CEscale <- get_metatab(ma_res_barriers)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
barriers_CEscale <- barriers_CEscale[-1,]
# not sign

metaregs_barriers <- rbind(barriers_age_metareg, barriers_prctfemale_metareg, barriers_Power_distance, barriers_Individualism, barriers_Masculinity, barriers_Uncertainty_Avoidance, barriers_Long_Term_Orientation, barriers_Indulgence, barriers_Year) %>% data.frame(.)
colnames(metaregs_barriers) <- c("Estimate", "SE", "p", "CILB", "CIUB")


barriers_Pub_status <- rename(barriers_Pub_status, Moderator = Pub_status_recode)
barriers_CEscale <- rename(barriers_CEscale, Moderator = CE_scale_recode)
barriers_scale <- rename(barriers_scale, Moderator = CRITERION_f)
catmods_barriers <- rbind(barriers_Pub_status, barriers_CEscale, barriers_scale)
```

### Career decidedness

```{r}
library(psychmeta)

# M_age
db_decidedness <- db %>% filter(., CRITERION_b == 'Career decidedness') 
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    
                    cat_moderators = FALSE,
                    data = db_decidedness)
decidedness_out_ic <- summary(ma_res_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_age_metareg <- decidedness_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_prctfemale_metareg <- decidedness_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Power_distance <- decidedness_Power_distance[2, ]
# not sign 

# Individualism
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Individualism <- decidedness_Individualism[2, ]
# not sign 

# Masculinity
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Masculinity <- decidedness_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                   
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Uncertainty_Avoidance <- decidedness_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Long_Term_Orientation <- decidedness_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Indulgence <- decidedness_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    data = db_decidedness)
summary(ma_res_decidedness)
decided_anova_pub_stat <- anova(ma_res_decidedness,  ma_method = "ic")

decidedness_pub_status_recode <- get_metatab(ma_res_decidedness)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)



# SCALE

ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CRITERION_f", 
                    cat_moderators = TRUE,
                    
                    data = db_decidedness)
summary(ma_res_decidedness)
decided_anova_scale <- anova(ma_res_decidedness,  ma_method = "ic")

decidedness_scale <- get_metatab(ma_res_decidedness)$individual_correction$true_score %>% select(construct_x, construct_y, CRITERION_f, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# Pub Year
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_decidedness)
ma_res_decidedness <- metareg(ma_res_decidedness)
get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_decidedness)[[1]]$individual_correction$true_score$Main
decidedness_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
decidedness_Year <- decidedness_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CE_scale_recode", 
                    
                    cat_moderators = TRUE,
                    data = db_decidedness)
summary(ma_res_decidedness)
decided_anova_ce_scale <- anova(ma_res_decidedness,  ma_method = "ic")

decidedness_CEscale <- get_metatab(ma_res_decidedness)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
decidedness_CEscale <- decidedness_CEscale[-1,]
# not sign

metaregs_decidedness <- rbind(decidedness_age_metareg, decidedness_prctfemale_metareg, decidedness_Power_distance, decidedness_Individualism, decidedness_Masculinity, decidedness_Uncertainty_Avoidance, decidedness_Long_Term_Orientation, decidedness_Indulgence, decidedness_Year) %>% data.frame(.)
colnames(metaregs_decidedness) <- c("Estimate", "SE", "p", "CILB", "CIUB")


decidedness_pub_status_recode <- rename(decidedness_pub_status_recode, Moderator = Pub_status_recode)
decidedness_CEscale <- rename(decidedness_CEscale, Moderator = CE_scale_recode)
decidedness_scale <- rename(decidedness_scale, Moderator = CRITERION_f)
catmods_decidedness <- rbind(decidedness_pub_status_recode, decidedness_CEscale, decidedness_scale)
```
### Career distress

```{r}
library(psychmeta)

# M_age
db_distress <- db %>% filter(., CRITERION_b == 'Career-related distress') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "M_age", 
                    cat_moderators = FALSE,
                   
                    data = db_distress)
distress_out_ic <- summary(ma_res_distress)
ma_res_distress <- metareg(ma_res_distress)
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_age_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_age_metareg <- distress_age_metareg[2, ]

# not sign 

# Prct_female
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                   
                    moderators = "Prct_female", 
                    cat_moderators = FALSE,
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_prctfemale_metareg <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_prctfemale_metareg <- distress_prctfemale_metareg[2, ]
# not sign 


# Power_distance
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Power_Distance", 
                    cat_moderators = FALSE,
                   
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Power_distance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Power_distance <- distress_Power_distance[2, ]
# not sign 

# Individualism
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Individualism", 
                    cat_moderators = FALSE,
                    
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Individualism <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Individualism <- distress_Individualism[2, ]
# not sign 

# Masculinity
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Masculinity", 
                    cat_moderators = FALSE,
                    
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Masculinity <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Masculinity <- distress_Masculinity[2, ]
# not sign

# Uncertainty_Avoidance
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Uncertainty_Avoidance", 
                    cat_moderators = FALSE,
                    
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Uncertainty_Avoidance <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Uncertainty_Avoidance <- distress_Uncertainty_Avoidance[2, ]
# not sign

# Long_Term_Orientation
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    
                    moderators = "Long_Term_Orientation", 
                    cat_moderators = FALSE,
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Long_Term_Orientation <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Long_Term_Orientation <- distress_Long_Term_Orientation[2, ]
# YES!!!

# Indulgence
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Indulgence", 
                    cat_moderators = FALSE,
                    
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Indulgence <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Indulgence <- distress_Indulgence[2, ]
# not sign 

# Pub_status_recode
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Pub_status_recode", 
                    cat_moderators = TRUE,
                    
                    data = db_distress)
summary(ma_res_distress)
distress_anova_pub_stat <- anova(ma_res_distress,  ma_method = "ic")


distress_Pub_status <- get_metatab(ma_res_distress)$individual_correction$true_score %>% select(construct_x, construct_y, Pub_status_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# SCALE
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CRITERION_f", 
                    cat_moderators = TRUE,
                    
                    data = db_distress)
summary(ma_res_distress)
distress_anova_scale <- anova(ma_res_distress,  ma_method = "ic")
distress_scale <- get_metatab(ma_res_distress)$individual_correction$true_score %>% select(construct_x, construct_y, CRITERION_f, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)


# Pub Year
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "Year", 
                    cat_moderators = FALSE,
                    
                    data = db_distress)
ma_res_distress <- metareg(ma_res_distress)
get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score
out_metareg <- get_metareg(ma_obj = ma_res_distress)[[1]]$individual_correction$true_score$Main
distress_Year <- cbind(out_metareg$beta, out_metareg$se, out_metareg$pval, out_metareg$ci.lb, out_metareg$ci.ub)
distress_Year <- distress_Year[2, ]
# not sign 

# CE_scale_recode
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                   construct_x = "CRITERION_b",
                    construct_y = "Predictor",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "CE_scale_recode", 
                   moderator_type = "simple",
                    cat_moderators = TRUE,
                   
                    data = db_distress)
summary(ma_res_distress)
distress_anova_ce_scale <- anova(ma_res_distress,  ma_method = "ic")

distress_CEscale <- get_metatab(ma_res_distress)$individual_correction$true_score %>% select(construct_x, construct_y, CE_scale_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
distress_CEscale <- distress_CEscale[-1,]
# not sign

metaregs_distress <- rbind(distress_age_metareg, distress_prctfemale_metareg, distress_Power_distance, distress_Individualism, distress_Masculinity, distress_Uncertainty_Avoidance, distress_Long_Term_Orientation, distress_Indulgence, distress_Year) %>% data.frame(.)
colnames(metaregs_distress) <- c("Estimate", "SE", "p", "CILB", "CIUB")


distress_Pub_status <- rename(distress_Pub_status, Moderator = Pub_status_recode)
distress_CEscale <- rename(distress_CEscale, Moderator = CE_scale_recode)
distress_scale  <- rename(distress_scale, Moderator = CRITERION_f)
catmods_distress <- rbind(distress_Pub_status, distress_CEscale, distress_scale)
```

#### Make table

```{r}
pvalr <- function(pvals, sig.limit = .001, digits = 2, html = FALSE) {

  roundr <- function(x, digits = 1) {
    res <- sprintf(paste0('%.', digits, 'f'), x)
    zzz <- paste0('0.', paste(rep('0', digits), collapse = ''))
    res[res == paste0('-', zzz)] <- zzz
    res
  }

  sapply(pvals, function(x, sig.limit) {
    if (x < sig.limit)
      if (html)
        return(sprintf('&lt; %s', format(sig.limit))) else
          return(sprintf('< %s', format(sig.limit)))
    if (x > .1)
      return(roundr(x, digits = 2)) else
        return(roundr(x, digits = digits))
  }, sig.limit = sig.limit)
}

roundr <- function(x, digits = 2) {
    res <- sprintf(paste0('%.', digits, 'f'), x)
    zzz <- paste0('0.', paste(rep('0', digits), collapse = ''))
    res[res == paste0('-', zzz)] <- zzz
    res
  }
```


```{r}

metaregs <- rbind(metaregs_CDSE, metaregs_expect, metaregs_goals, metaregs_support, metaregs_barriers, metaregs_decidedness, metaregs_distress) %>% lapply(., as.numeric) %>% data.frame(.)

metaregs$CILB[metaregs$CILB < -1] <- -1.00
metaregs$CILB[metaregs$CIUB > 1] <- 1.00


metaregs$Estimate <- metaregs$Estimate  %>% as.numeric(.)  %>% roundr(., digits = 3) %>%  as.character(.) 
metaregs$SE <-metaregs$SE %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) 
metaregs$p <-metaregs$p  %>% roundr(., digits =3)  %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
metaregs$CILB <-metaregs$CILB %>% as.numeric(.)  %>% roundr(., digits = 3) %>%  as.character(.) 
metaregs$CIUB <-metaregs$CIU %>% as.numeric(.)  %>% roundr(., digits = 3) %>%  as.character(.) 


metaregs$CI95 <- (paste(metaregs$CILB, ", ",metaregs$CIUB, sep=""))
Moderator <- rep(c("Age", "Percent female", "Power distance", "Individualism", "Masculinity", "Uncertainty avoid", "Long term orientation", "Indulgence", "Pub year"), 7)

library(xtable)
metaregs <- metaregs %>% select(Estimate, SE, p, CI95)
metaregs <- cbind(Moderator, metaregs)
metaregs$p[metaregs$p == ".000"] <- "<.001"
metaregs$SE[metaregs$SE == "0.00"] <- "<0.01"


colnames(metaregs) <- c("Moderator", "Estimate", "\\textit{SE}", "\\textit{p}", "95\\% CI")
metaregs <- metaregs[- grep("Power distance", metaregs$Moderator),]
metaregs <- metaregs[- grep("Masculinity", metaregs$Moderator),]
metaregs <- metaregs[- grep("Uncertainty avoid", metaregs$Moderator),]
metaregs <- metaregs[- grep("Long term orientation", metaregs$Moderator),]
metaregs <- metaregs[- grep("Indulgence", metaregs$Moderator),]
`Criterion variable`  <- c("CESE/CDSE", "", "","",
             "Expectations", "", "","",
             "Exploratory goals", "", "","",
             "Career support", "", "","",
             "Career barriers", "", "","",
             "Decidedness", "", "","",
             "Decisional distress", "", "","")

metaregs <- cbind(`Criterion variable`, metaregs)
print(xtable(metaregs, type = "latex"), file = "outputs/metaregs.tex", include.rownames = F , sanitize.text.function = force) 

catmods  <- rbind(catmods_CDSE, catmods_expect, catmods_goals, catmods_support, catmods_barriers, catmods_decidedness, catmods_distress) %>% select(Moderator, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
catmods$k <- catmods$k   %>% as.numeric(.)  %>% roundr(., digits = 0) %>%  as.character(.) 
catmods$N <- catmods$N   %>% as.numeric(.) %>% roundr(., digits = 0)  %>% as.numeric(.) %>% format(., big.mark = ',')  %>%  as.character(.) 
catmods$mean_r <- catmods$mean_r %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$mean_rho <- catmods$mean_rho %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CI_LL_95 <- catmods$CI_LL_95 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CI_UL_95 <- catmods$CI_UL_95 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CR_LL_80 <- catmods$CR_LL_80 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CR_UL_80 <- catmods$CR_UL_80 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)

catmods <- data.frame(catmods)
catmods$CI95 <- paste(catmods$CI_LL_95, ", ",catmods$CI_UL_95, sep="")
catmods$CR80 <- (paste(catmods$CR_LL_80, ", ",catmods$CR_UL_80, sep=""))
catmods <- catmods %>% select(Moderator, k, N, mean_r, mean_rho, CI95, CR80)
colnames(catmods) <- c("Moderator", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "95\\% CI", "80\\% CR")
catmods$Moderator <- paste0("& \\hspace{6mm}", catmods$Moderator)

catmods <- cbind(`Criterion variable`, catmods)

print(xtable(catmods, type = "latex"), file = "outputs/catmods.tex", include.rownames = F , sanitize.text.function = force) 

anovas_catmods <- rbind(CRSE_anova_pub_stat, expect_anova_pub_stat, goals_anova_pub_stat, support_anova_pub_stat, barriers_anova_pub_stat,
                        decided_anova_pub_stat, distress_anova_pub_stat, 
                        CRSE_anova_ce_scale, expect_anova_ce_scale, goals_anova_ce_scale, support_anova_ce_scale, barriers_anova_ce_scale,
                        decided_anova_ce_scale, distress_anova_ce_scale,
                        expect_anova_scale, support_anova_scale, barriers_anova_scale, decided_anova_scale, distress_anova_scale) %>% select(construct_x, `F value`, mean_1, mean_2, diff, CI_LL_95, CI_UL_95)

anovas_catmods$`F value` <- anovas_catmods$`F value` %>% as.numeric(.)  %>% roundr(., digits = 2)
anovas_catmods$mean_1 <- anovas_catmods$mean_1 %>% as.numeric(.)  %>% roundr(., digits = 2) %>% gsub("0\\.", "\\.", .)
anovas_catmods$mean_2 <- anovas_catmods$mean_2 %>% as.numeric(.)  %>% roundr(., digits = 2) %>% gsub("0\\.", "\\.", .)
anovas_catmods$diff <- anovas_catmods$diff %>% as.numeric(.)  %>% roundr(., digits = 2) %>% gsub("0\\.", "\\.", .)
anovas_catmods$CI_UL_95 <- anovas_catmods$CI_UL_95 %>% as.numeric(.)  %>% roundr(., digits = 2)  %>% gsub("0\\.", "\\.", .)
anovas_catmods$CI_LL_95 <- anovas_catmods$CI_LL_95 %>% as.numeric(.)  %>% roundr(., digits = 2)  %>% gsub("0\\.", "\\.", .)

anovas_catmods$CI95 <- paste(anovas_catmods$CI_LL_95, ", ",anovas_catmods$CI_UL_95, sep="")
anovas_catmods <- anovas_catmods  %>% select(construct_x, `F value`, mean_1, mean_2, diff, CI95)
colnames(anovas_catmods) <- c("Criterion variable", "\\textit{F}", "Mean_1", "Mean_2", "Diff.", "95\\% CI")
anovas_catmods$`Criterion variable` <- paste0("\\hspace{3mm} ", anovas_catmods$`Criterion variable`)

print(xtable(anovas_catmods, type = "latex"), file = "outputs/anovas_catmods.tex", include.rownames = F , sanitize.text.function = force) 


```

## Probing continous moderators with categories

```{r}
# collectivist vs individualist culture
db$collect_individ_recode <- cut(db$Individualism,
                                 breaks = c(-Inf, 50, 100),
                                 labels = c("cllectivist", "individualist"))
db$male_female_recode <- cut(db$Prct_female,
                                 breaks = c(-Inf, 50, 100),
                                 labels = c("male", "female"))

db$new_old <- cut(db$Year,
                                 breaks = c(-Inf, 2004, 2020),
                                 labels = c("old", "new"))


## career related self efficacy 
# collect vs individ
db_CDSE <- db %>% filter(., CRITERION_b == 'Career-related self-efficacy') 
ma_res_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Career-related self-efficacy",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "collect_individ_recode", 
                    cat_moderators = TRUE,
                    data = db_CDSE)
summary(ma_res_CDSE)
anova(ma_res_CDSE)
CDSE_collect_individ <- get_metatab(ma_res_CDSE)$individual_correction$true_score %>% select(construct_x, construct_y, collect_individ_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

## outcome expectations
# female
db_expect <- db %>% filter(., CRITERION_b == 'Outcome expectations') 
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Outcome expectations",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "male_female_recode", 
                    cat_moderators = TRUE,
                    data = db_expect)
summary(ma_res_expect)
anova(ma_res_expect)
expect_male_female <- get_metatab(ma_res_expect)$individual_correction$true_score %>% select(construct_x, construct_y, male_female_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

# Pub year
ma_res_expect <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Outcome expectations",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "new_old", 
                    cat_moderators = TRUE,
                    data = db_expect)
summary(ma_res_expect)
anova(ma_res_expect)
expect_new_old <- get_metatab(ma_res_expect)$individual_correction$true_score %>% select(construct_x, construct_y, new_old, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

## Career barriers
# collect vs individ
db_barriers <- db %>% filter(., CRITERION_b == 'Barriers') 
ma_res_barriers <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Barriers",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "collect_individ_recode", 
                    cat_moderators = TRUE,
                    data = db_barriers)
summary(ma_res_barriers)
anova(ma_res_barriers)
barriers_collect_individ_recode <- get_metatab(ma_res_barriers)$individual_correction$true_score %>% select(construct_x, construct_y, collect_individ_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)

## Decidedness
# female
db_decidedness <- db %>% filter(., CRITERION_b == 'Career decidedness') 
ma_res_decidedness <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Career decidedness",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "male_female_recode", 
                    cat_moderators = TRUE,
                    data = db_decidedness)
summary(ma_res_decidedness)
anova(ma_res_decidedness)
decidedness_male_female_recode <- get_metatab(ma_res_decidedness)$individual_correction$true_score %>% select(construct_x, construct_y, male_female_recode, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
decidedness_male_female_recode <- decidedness_male_female_recode[-1,]


## Distress
# pub year
db_distress <- db %>% filter(., CRITERION_b == 'Career-related distress') 
ma_res_distress <- ma_r(ma_method = "ic",
                    rxyi = Rxy,
                    n = N, 
                    rxx = Rxx_Criterion,
                    ryy = Ryy_Exploration,
                    construct_x = "Career-related distress",
                    construct_y = "Career exploration",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = 'sample_size',
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    moderators = "new_old", 
                    cat_moderators = TRUE,
                    data = db_distress)
summary(ma_res_distress)
anova(ma_res_distress)
distress_new_old <- get_metatab(ma_res_distress)$individual_correction$true_score %>% select(construct_x, construct_y, new_old, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
distress_new_old <- distress_new_old[-1,]

```

### Make table
```{r}
catmods  <- rbind(catmods_CDSE, catmods_expect, catmods_goals, catmods_support, catmods_barriers, catmods_decidedness, catmods_distress) %>% select(Moderator, k, N, mean_r, mean_rho, CI_LL_95, CI_UL_95, CR_LL_80, CR_UL_80)
catmods$k <- catmods$k   %>% as.numeric(.)  %>% roundr(., digits = 0) %>%  as.character(.) 
catmods$N <- catmods$N   %>% as.numeric(.) %>% roundr(., digits = 0)  %>% as.numeric(.) %>% format(., big.mark = ',')  %>%  as.character(.) 
catmods$mean_r <- catmods$mean_r %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) 
catmods$mean_rho <- catmods$mean_rho %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CI_LL_95 <- catmods$CI_LL_95 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CI_UL_95 <- catmods$CI_UL_95 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CR_LL_80 <- catmods$CR_LL_80 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)
catmods$CR_UL_80 <- catmods$CR_UL_80 %>% as.numeric(.)  %>% roundr(., digits = 2) %>%  as.character(.) %>% gsub("0\\.", "\\.", .)

catmods <- data.frame(catmods)
catmods$CI95 <- paste(catmods$CI_LL_95, ", ",catmods$CI_UL_95, sep="")
catmods$CR80 <- (paste(catmods$CR_LL_80, ", ",catmods$CR_UL_80, sep=""))
catmods <- catmods %>% select(Moderator, k, N, mean_r, mean_rho, CI95, CR80)
colnames(catmods) <- c("Moderator", "\\textit{k}", "\\textit{N}", "\\textit{r}", "\\textit{$r_c$}", "95\\% CI", "80\\% CR")

print(xtable(catmods, type = "latex"), file = "outputs/catmods.tex", include.rownames = F , sanitize.text.function = force) 
```



# Mediation model

# TSSEM with composite correlations

## Preparation

```{r}
library(readxl)
library(tidyverse)
library(psychmeta)
library(xtable)
db_med <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx", sheet = 'Med_models')
intercor <- read_excel("codesheet/Codesheet_Career_Exploration_070721.xlsx", sheet = "Intercor")

cols.num <- c("Sample_number","Year", "N", "Ryy", "Rxx", "Rxy")
cols.num_intercor <- c("Intercor_ID", "Intercor_rxy", "Intercor_N")
db_med[cols.num] <- sapply(db_med[cols.num],as.numeric) # make some cols numeric
intercor[cols.num_intercor] <- sapply(intercor[cols.num_intercor],as.numeric) # 


df_Explor_CDSE <- db_med[ (db_med$Predictor == 'Career exploration')  & (db_med$CRITERION_b ==  'Career-related self-efficacy'), ] %>% rename(Cor_Explor_CDSE = Rxy)
df_Explor_Goals<- db_med[ (db_med$Predictor == 'Career engagement goals')  & (db_med$CRITERION_b ==  'Career exploration') , ] %>% rename(Cor_Explor_Goals = Rxy)
df_Explor_Expect <- db_med[ (db_med$Predictor == 'Career exploration')  & (db_med$CRITERION_b ==  'Outcome expectations') , ] %>% rename(Cor_Explor_Expect = Rxy)

df_CDSE_Goals <- db_med[ (db_med$Predictor == 'Career-related self-efficacy')  & (db_med$CRITERION_b ==  'Career engagement goals') , ] %>% rename(Cor_CDSE_Goals = Rxy)
df_Goals_Expect <- db_med[ (db_med$Predictor == 'Career engagement goals')  & (db_med$CRITERION_b ==  'Outcome expectations') , ] %>% rename(Cor_Goals_Expect = Rxy)
df_CDSE_Expect <- db_med[ (db_med$Predictor == 'Career-related self-efficacy')  & (db_med$CRITERION_b ==  'Outcome expectations') , ] %>% rename(Cor_CDSE_Expect = Rxy)


# Composite relationships
# Explor_CDSE
intercor_cons <-  control_intercor(rxyi = Intercor_rxy, n = Intercor_N, sample_id = Intercor_ID, construct_x = Intercor_x, construct_y = Intercor_y, data = intercor, intercor_scalar <- .5)

Explor_CDSE <- ma_r(ma_method = "ic",
                    rxyi = Cor_Explor_CDSE,
                    n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = df_Explor_CDSE)
Explor_CDSE <- get_escalc(Explor_CDSE)
Cor_explor_CDSE <- Explor_CDSE$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_explor_CDSE$Sample_number <- as.numeric(as.character(Cor_explor_CDSE$Sample_number)) 
df_Explor_CDSE <- df_Explor_CDSE %>% select(-matches("Rxy|Rxx|Ryy|Cor_Explor_CDSE"))
df_Explor_CDSE <- unique(left_join(df_Explor_CDSE, Cor_explor_CDSE,  by = "Sample_number")) %>% rename(Explor_CDSE = yi)

# Explor_Goals
Explor_Goals <- ma_r(rxyi = Cor_Explor_Goals,
                     n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = df_Explor_Goals)
Explor_Goals <- get_escalc(Explor_Goals)
Cor_explor_Goals <- Explor_Goals$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_explor_Goals$Sample_number <- as.numeric(as.character(Cor_explor_Goals$Sample_number)) 
df_Explor_Goals <- df_Explor_Goals %>% select(-matches("Rxy|Rxx|Ryy|Cor_Explor_Goals"))
df_Explor_Goals <- unique(left_join(df_Explor_Goals, Cor_explor_Goals,  by = "Sample_number")) %>% rename(Explor_Goals =  yi)

# Explor_Expect
Explor_Expect <- ma_r(rxyi = Cor_Explor_Expect,
                      n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = df_Explor_Expect)
Explor_Expect <- get_escalc(Explor_Expect)
Cor_explor_Expect <- Explor_Expect$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_explor_Expect$Sample_number <- as.numeric(as.character(Cor_explor_Expect$Sample_number)) 
df_Explor_Expect <- df_Explor_Expect %>% select(-matches("Rxy|Rxx|Ryy|Cor_Explor_Expect"))
df_Explor_Expect <- unique(left_join(df_Explor_Expect, Cor_explor_Expect,  by = "Sample_number") ) %>% rename(Explor_Expect = yi)

# CDSE_Goals
CDSE_Goals <- ma_r(rxyi = Cor_CDSE_Goals,
                   n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                   data = df_CDSE_Goals)
CDSE_Goals<- get_escalc(CDSE_Goals)
Cor_CDSE_Goals<- CDSE_Goals$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_CDSE_Goals$Sample_number <- as.numeric(as.character(Cor_CDSE_Goals$Sample_number)) 
df_CDSE_Goals<- df_CDSE_Goals%>% select(-matches("Rxy|Rxx|Ryy|Cor_CDSE_Goals"))
df_CDSE_Goals<- unique(left_join(df_CDSE_Goals, Cor_CDSE_Goals,  by = "Sample_number")) %>% rename(CDSE_Goals = yi)

# Goals_Expect
Goals_Expect <- ma_r(rxyi = Cor_Goals_Expect,
                     n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = df_Goals_Expect)
Goals_Expect<- get_escalc(Goals_Expect)
Cor_Goals_Expect<- Goals_Expect$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_Goals_Expect$Sample_number <- as.numeric(as.character(Cor_Goals_Expect$Sample_number)) 
df_Goals_Expect<- df_Goals_Expect%>% select(-matches("Rxy|Rxx|Ryy|Cor_Goals_Expect"))
df_Goals_Expect<- unique(left_join(df_Goals_Expect, Cor_Goals_Expect,  by = "Sample_number")) %>% rename(Goals_Expect = yi)

# CDSE_Expect
CDSE_Expect <- ma_r(rxyi = Cor_CDSE_Expect,
                    n = N, 
                    rxx = Rxx,
                    ryy = Ryy,
                    construct_x = "Predictor",
                    construct_y = "CRITERION_b",
                    sample_id = "Sample_number", 
                    collapse_method = "composite",
                    intercor = intercor_cons,
                    wt_type = "sample_size",
                    correct_rxx = TRUE, 
                    correct_ryy = TRUE, 
                    impute_artifacts = TRUE,
                    data = df_CDSE_Expect)
CDSE_Expect<- get_escalc(CDSE_Expect)
Cor_CDSE_Expect<- CDSE_Expect$`analysis_id: 1`$barebones %>% select(yi, sample_id) %>% rename(Sample_number = sample_id) 
Cor_CDSE_Expect$Sample_number <- as.numeric(as.character(Cor_CDSE_Expect$Sample_number)) 
df_CDSE_Expect<- df_CDSE_Expect%>% select(-matches("Rxy|Rxx|Ryy|Cor_CDSE_Expect"))
df_CDSE_Expect<- unique(left_join(df_CDSE_Expect, Cor_CDSE_Expect,  by = "Sample_number")) %>% rename(CDSE_Expect = yi)



db_med <- full_join(df_Explor_CDSE, df_Explor_Goals, by = c("Pub_status", "Sample_number", "N",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Year", "Individualism"))
db_med <- full_join(db_med, df_Explor_Expect, by = c("Pub_status", "Sample_number", "N",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Year", "Individualism"))
db_med <- full_join(db_med, df_CDSE_Goals, by = c("Pub_status", "Sample_number", "N",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Year", "Individualism"))
db_med <- full_join(db_med, df_Goals_Expect, by = c("Pub_status", "Sample_number", "N",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Year", "Individualism"))
db_med <- full_join(db_med, df_CDSE_Expect, by = c("Pub_status", "Sample_number", "N",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Year", "Individualism")) %>% select(-matches('Predictor|CRITERION|Ryy|Rxx'))

names(db_med)

# Dataset without Career exploration self-efficacy
data_min1 <- db_med[c("Sample_number", "N", "Explor_CDSE", "Explor_Goals", "Explor_Expect", "CDSE_Expect","CDSE_Goals", "Goals_Expect",  "Year", "Pub_status",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Individualism")]

# Dataset without exploration self-efficacy and career expectations 
data_CDSE <- db_med[c("Sample_number", "N", "Explor_CDSE", "Explor_Goals","CDSE_Goals", "Year", "Pub_status",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Individualism")]

data_expect<- db_med[c("Sample_number", "N", "Explor_Expect", "Explor_Goals","Goals_Expect", "Year", "Pub_status",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Individualism")]

data_CRSE_expect_goals<- db_med[c("Sample_number", "N", "CDSE_Expect", "CDSE_Goals","Goals_Expect", "Year", "Pub_status",  "CE_scale", "Reference_period", "Field", "Country", "Prct_female","M_age", "SD_age", "Individualism")]

```

## CDSE

### Create correlation matrices - mediation model

```{r}
library(metaSEM)
data_CDSE <- data_CDSE[!with(data_CDSE,is.na(Explor_CDSE)& is.na(Explor_Goals)& is.na(CDSE_Goals) ),]
varnames <- c("Exploration","CDSE", "Goals")
labels <- list(varnames,varnames) 
cordat1 <- list()
for (i in 1:nrow(data_CDSE)){
cordat1[[i]] <- vec2symMat(as.matrix(data_CDSE[i,c(3:5)]),diag = FALSE)
dimnames(cordat1[[i]]) <- labels}

```

### Put NA on diagonal for variable with least present correlations
```{r}
nvar <- 3
for (i in 1:length(cordat1)) {
  for (j in 1:nrow(cordat1[[i]])) {
    for (k in 1:nvar){
      if (is.na(cordat1[[i]][j,k] == TRUE)
          &is.na(cordat1[[i]][j,j]) != TRUE
          &is.na(cordat1[[i]][k,k]) != TRUE) {
        if(sum(is.na(cordat1[[i]])[j,]) > sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][k,k] <- NA}
        if(sum(is.na(cordat1[[i]])[j,]) <= sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][j,j] <- NA}
          }}}}
```

### Random effects analysis 

```{r}
stage1random <- tssem1(Cov = cordat1, n = data_CDSE$N, method = "REM", RE.type = "Diag")
summary(stage1random)
# does only work for dataset with three variables (career exploration, career engagement goals, Career-related self-efficacy), otherwise, not positive definite
```

### Create mxMatrices - only indirect effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, 0 , "0.1*Med2DV",
    0, 0, 0,
    0, "0.1*IV2Med", 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)

# S Matrix

S <- create.mxMatrix(
  c("0.1*VarExpl",
    0, 1,
    0, 0,  "0.1*VarGoals"),
  type = "Symm",
  byrow = TRUE,
  name = "S",
  dimnames = list(varnames, varnames)
)

#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras=list(Ind1 =mxAlgebra(IV2Med*Med2DV,name="Ind1")))



str(summary(stage2))
fit_CDSE_direct <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_CDSE_direct_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)
summary(rerun(stage2))$mx.algebras
fit_CDSE_direct_effects <- summary(rerun(stage2))$mx.algebras  %>% round_df(., 3)

fit_CDSE_indirect <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_CDSE_indirect_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)
summary(rerun(stage2))$mx.algebras
fit_CDSE_indirect_effects <- summary(rerun(stage2))$mx.algebras  %>% round_df(., 3)

```

### Create mxMatrices - plus direct effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, "0.1*IV2Med" , 0,
    0, 0, 0,
    "0.1*Med2DV", "0.1*IV2DV", 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)

#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras=list(Ind1 =mxAlgebra(IV2Med*Med2DV,name="Ind1")))
summary(rerun(stage2)) 

fit_CDSE_direct <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_CDSE_direct_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)
summary(rerun(stage2))$mx.algebras
fit_CDSE_direct_effects <- summary(rerun(stage2))$mx.algebras  %>% round_df(., 3)
```

#### Plot
```{r}
library(semPlot)
library(nloptr)
my.plot <- meta2semPlot(stage2)
semPaths(my.plot, whatLabels = "est", layout = "tree2")
```

#### Probe the indirect effect

```{r}
stage2ind <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras = list(
                   Indirect = mxAlgebra(IV2Med*Med2DV, name = "Indirect")
                 ))
summary(stage2ind)
```

## expect

### Create correlation matrices - mediation model

```{r}
library(metaSEM)
data_expect <- data_expect[!with(data_expect,is.na(Explor_Expect)& is.na(Explor_Goals)& is.na(Goals_Expect) ),]

varnames <- c("Exploration","Expect",  "Goals")
labels <- list(varnames,varnames) 
cordat1 <- list()
for (i in 1:nrow(data_expect)){
cordat1[[i]] <- vec2symMat(as.matrix(data_expect[i,c(3:5)]),diag = FALSE)
dimnames(cordat1[[i]]) <- labels}
```

### Put NA on diagonal for variable with least present correlations
```{r}
nvar <- 3
for (i in 1:length(cordat1)) {
  for (j in 1:nrow(cordat1[[i]])) {
    for (k in 1:nvar){
      if (is.na(cordat1[[i]][j,k] == TRUE)
          &is.na(cordat1[[i]][j,j]) != TRUE
          &is.na(cordat1[[i]][k,k]) != TRUE) {
        if(sum(is.na(cordat1[[i]])[j,]) > sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][k,k] <- NA}
        if(sum(is.na(cordat1[[i]])[j,]) <= sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][j,j] <- NA}
          }}}}
```

### Random effects analysis 

```{r}
stage1random <- rerun(tssem1(Cov = cordat1, n = data_expect$N, method = "REM", RE.type = "Diag"))
summary(stage1random)
summary(rerun(stage1random))

# does only work for dataset with three variables (career exploration, career engagement goals, Career-related self-efficacy), otherwise, not positive definite
```

### Create mxMatrices - only indirect effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, 0 , "0.1*Med2DV",
    0, 0, 0,
    0, "0.1*IV2Med", 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)

# S Matrix

S <- create.mxMatrix(
  c("0.1*VarExpl",
    0, 1,
    0, 0,  "0.1*VarGoals"),
  type = "Symm",
  byrow = TRUE,
  name = "S",
  dimnames = list(varnames, varnames)
)


#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras=list(Ind1 =mxAlgebra(IV2Med*Med2DV,name="Ind1")))
summary(stage2)
summary(rerun(stage2)) 
fit_expect_indirect <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_expect_indirect_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)
fit_expect_iindirect_effects <- summary(rerun(stage2))$mx.algebra %>% round_df(., 3)

```

### Create mxMatrices - plus direct effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, "0.1*IV2Med" , 0,
    0, 0, 0,
    "0.1*Med2DV", "0.1*IV2DV", 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)


#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras=list(Ind1 =mxAlgebra(IV2Med*Med2DV,name="Ind1")))
summary(stage2)
summary(rerun(stage2)) 

fit_expect_direct <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_expect_direct_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)
fit_expect_direct_effects <- summary(rerun(stage2))$mx.algebra %>% round_df(., 3)
```

#### Plot
```{r}
library(semPlot)
my.plot <- meta2semPlot(stage2)
semPaths(my.plot, whatLabels = "est", layout = "tree2")
```

#### Probe the indirect effect

```{r}
stage2ind <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras = list(
                   Indirect = mxAlgebra(IV2Med*Med2DV, name = "Indirect")
                 ))
summary(stage2ind)
```

## make table

```{r}
# get fit indices 
fit_models <- cbind(data.frame(fit_CDSE_indirect), data.frame(fit_expect_indirect))

fitvalues_table <- fit_models %>% t(.) %>% as.data.frame(.) %>% select("Sample size", "Chi-square of target model", "DF of target model", "p value of target model", "RMSEA", "RMSEA lower 95% CI", "RMSEA upper 95% CI", "SRMR", "TLI", "CFI")

names(fitvalues_table) <- c("N", "Chisq", "df", "p", "RMSEA", "RMSEA_lo", "RMSEA_up","SRMR", "TLI", "CFI")

fitvalues_table$p <- round(fitvalues_table$p,  3) 
fitvalues_table$RMSEA <-  round(fitvalues_table$RMSEA, 3)
fitvalues_table$RMSEA_lo <-  round(fitvalues_table$RMSEA_lo, 3)
fitvalues_table$N <- formatC(fitvalues_table$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
fitvalues_table$SRMR <-  pvalr(fitvalues_table$SRMR)
fitvalues_table$TLI <-  pvalr(fitvalues_table$TLI)
fitvalues_table$CFI <-  pvalr(fitvalues_table$CFI)
fitvalues_table$Chisq <- (paste(fitvalues_table$Chisq, " (",fitvalues_table$df, ")", sep=""))
fitvalues_table$RMSEA <- (paste(fitvalues_table$RMSEA, " (",fitvalues_table$RMSEA_lo, "-", fitvalues_table$RMSEA_up, ")", sep=""))

fittable <- fitvalues_table %>% select("N", "Chisq", "p", "RMSEA", "SRMR", "TLI", "CFI") 
IV <- c("CRSE",  "Expectations")
fittable <- cbind(IV, fittable)
colnames(fittable) <- c("Independent variable", "\\textit{N}", "\\chi^2(\\textit{df})", "\\textit{p}", "RMSEA (95\\% CI)", "SRMR", "TLI", "CFI") 

print(xtable(fittable, type = "latex"), file = "outputs/fitvalues_medmodel.tex", include.rownames = F , sanitize.text.function = force) 

# get indirect effects
ind_effects_CDSE <- data.frame(fit_CDSE_direct_estimates) %>% select("Estimate", "lbound", "ubound") %>% rbind(., fit_CDSE_direct_effects)
ind_effects_expect <- data.frame(fit_expect_direct_estimates) %>% select("Estimate", "lbound", "ubound") %>% rbind(., fit_expect_direct_effects)

ind_effects_table <- rbind(ind_effects_CDSE, ind_effects_expect)
names(ind_effects_table) <- c("Estimate", "Lower bound", "Upper bound")

ind_effects_table <- ind_effects_table[- grep("Var", rownames(ind_effects_table)),]

Paths <- c( "\\hspace{6mm}CESE/CDSE $\\rightarrow$ Goals", 
            "\\hspace{6mm}CESE/CDSE $\\rightarrow$ Exploration",
            "\\hspace{6mm}Goals $\\rightarrow$ Exploration", 
            "\\hspace{6mm}CESE/CDSE $\\rightarrow$ Goals $\\rightarrow$ Exploration", 
            
            "\\hspace{6mm}Expectations $\\rightarrow$ Goals", 
            "\\hspace{6mm}Expectations $\\rightarrow$ Exploration", 
            "\\hspace{6mm}Goals $\\rightarrow$ Exploration", 
            "\\hspace{6mm}Expectations $\\rightarrow$ Goals $\\rightarrow$ Exploration")

ind_effects_table$Estimate <- formatC(ind_effects_table$Estimate, format = "f", zero.print = T, digits = 2) 
ind_effects_table$`Lower bound` <- formatC(ind_effects_table$`Lower bound`, format = "f", zero.print = T, digits = 2) 
ind_effects_table$`Upper bound` <- formatC(ind_effects_table$`Upper bound`, format = "f", zero.print = T, digits = 2) 

ind_effects_table$CI95 <- (paste(ind_effects_table$`Lower bound`, ", ",ind_effects_table$`Upper bound`, sep="")) 

ind_effects_table <- ind_effects_table %>% select(-matches("bound"))

indeffectstable <- cbind(Paths, ind_effects_table)

print(xtable(indeffectstable, type = "latex"), file = "outputs/indirect_effects.tex", include.rownames = F , sanitize.text.function = force)
```


# Exploratory mediation models

## CDSE

### Create correlation matrices - mediation model

```{r}
library(metaSEM)
data_CDSE <- data_CDSE[!with(data_CDSE,is.na(Explor_CDSE)& is.na(Explor_Goals)& is.na(CDSE_Goals) ),]
varnames <- c("Exploration","CDSE",  "Goals")
labels <- list(varnames,varnames) 
cordat1 <- list()
for (i in 1:nrow(data_CDSE)){
cordat1[[i]] <- vec2symMat(as.matrix(data_CDSE[i,c(3:5)]),diag = FALSE)
dimnames(cordat1[[i]]) <- labels}
```

### Put NA on diagonal for variable with least present correlations
```{r}
nvar <- 3
for (i in 1:length(cordat1)) {
  for (j in 1:nrow(cordat1[[i]])) {
    for (k in 1:nvar){
      if (is.na(cordat1[[i]][j,k] == TRUE)
          &is.na(cordat1[[i]][j,j]) != TRUE
          &is.na(cordat1[[i]][k,k]) != TRUE) {
        if(sum(is.na(cordat1[[i]])[j,]) > sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][k,k] <- NA}
        if(sum(is.na(cordat1[[i]])[j,]) <= sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][j,j] <- NA}
          }}}}
```

### Random effects analysis 

```{r}
stage1random <- tssem1(Cov = cordat1, n = data_CDSE$N, method = "REM", RE.type = "Diag")
summary(stage1random)
# does only work for dataset with three variables (career exploration, career engagement goals, Career-related self-efficacy), otherwise, not positive definite
```

### Create mxMatrices - only indirect effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, "0.1*IV2Med", 0,
    0, 0, 0,
    "0.1*Med2DV", 0, 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)

# S Matrix

S <- create.mxMatrix(
  c("0.1*VarM",
    0, 1,
    0, 0,  "0.1*VarDV"),
  type = "Symm",
  byrow = TRUE,
  name = "S",
  dimnames = list(varnames, varnames)
)


#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = T, intervals = "LB")
summary(stage2)
str(summary(rerun(stage2)))

fit_CDSE <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_CDSE_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)

```

#### Plot
```{r}
library(semPlot)
my.plot <- meta2semPlot(stage2)
semPaths(my.plot, whatLabels = "est", layout = "tree2")
```

#### Probe the indirect effect

```{r}
stage2ind <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras = list(
                   Indirect = mxAlgebra(IV2Med*Med2DV, name = "Indirect")
                 ))
summary(stage2ind)
```

## expect

### Create correlation matrices - mediation model

```{r}
library(metaSEM)
data_expect <- data_expect[!with(data_expect,is.na(Explor_Expect)& is.na(Explor_Goals)& is.na(Goals_Expect) ),]

varnames <- c("Exploration","Expect",  "Goals")
labels <- list(varnames,varnames) 
cordat1 <- list()
for (i in 1:nrow(data_expect)){
cordat1[[i]] <- vec2symMat(as.matrix(data_expect[i,c(3:5)]),diag = FALSE)
dimnames(cordat1[[i]]) <- labels}
```

### Put NA on diagonal for variable with least present correlations
```{r}
nvar <- 3
for (i in 1:length(cordat1)) {
  for (j in 1:nrow(cordat1[[i]])) {
    for (k in 1:nvar){
      if (is.na(cordat1[[i]][j,k] == TRUE)
          &is.na(cordat1[[i]][j,j]) != TRUE
          &is.na(cordat1[[i]][k,k]) != TRUE) {
        if(sum(is.na(cordat1[[i]])[j,]) > sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][k,k] <- NA}
        if(sum(is.na(cordat1[[i]])[j,]) <= sum(is.na(cordat1[[i]])[k,]))
        {cordat1[[i]][j,j] <- NA}
          }}}}
```

### Random effects analysis 

```{r}
stage1random <- tssem1(Cov = cordat1, n = data_expect$N, method = "REM", RE.type = "Diag")
summary(stage1random)
summary(rerun(stage1random))
# does only work for dataset with three variables (career exploration, career engagement goals, Career-related self-efficacy), otherwise, not positive definite
```

### Create mxMatrices - only indirect effects 

```{r}
# A Matrix
cordat1[[1]]
A <- create.mxMatrix(
  c(0, "0.1*IV2Med", 0,
    0, 0, 0,
    "0.1*Med2DV", 0, 0),
  type = "Full",
  nrow = 3,
  ncol = 3,
  byrow = TRUE,
  name = "A",
  dimnames = list(varnames, varnames), 
  as.mxMatrix = T
)

# S Matrix

S <- create.mxMatrix(
  c("0.1*VarM",
    0, 1,
    0, 0,  "0.1*VarDV"),
  type = "Symm",
  byrow = TRUE,
  name = "S",
  dimnames = list(varnames, varnames)
)


#### Fitting the model

stage2 <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = T, intervals = "LB")
summary(stage2)
str(summary(rerun(stage2)))

fit_expect <- summary(rerun(stage2))$stat %>% round_df(., 3)
fit_expect_estimates <- summary(rerun(stage2))$coefficients %>% round_df(., 3)

```

#### Plot
```{r}
library(semPlot)
my.plot <- meta2semPlot(stage2)
semPaths(my.plot, whatLabels = "est", layout = "tree2")
```

#### Probe the indirect effect

```{r}
stage2ind <- tssem2(stage1random, Amatrix = A, Smatrix = S, diag.constraints = TRUE, intervals = "LB",
                 mx.algebras = list(
                   Indirect = mxAlgebra(IV2Med*Med2DV, name = "Indirect")
                 ))
summary(stage2ind)
```

## make table

```{r}
# get fit indices 
fit_models <- cbind(data.frame(fit_CDSE), data.frame(fit_expect))

fitvalues_table <- fit_models %>% t(.) %>% as.data.frame(.) %>% select("Sample size", "Chi-square of target model", "DF of target model", "p value of target model", "RMSEA", "RMSEA lower 95% CI", "RMSEA upper 95% CI", "SRMR", "TLI", "CFI")

names(fitvalues_table) <- c("N", "Chisq", "df", "p", "RMSEA", "RMSEA_lo", "RMSEA_up","SRMR", "TLI", "CFI")

fitvalues_table$p <- round(fitvalues_table$p,3)
fitvalues_table$RMSEA <-  round(fitvalues_table$RMSEA,2)
fitvalues_table$RMSEA_lo <-  round(fitvalues_table$RMSEA_lo,2)
fitvalues_table$N <- formatC(fitvalues_table$N, big.mark = ",", format = "f", zero.print = T, digits = 0) 
fitvalues_table$SRMR <-  round(fitvalues_table$SRMR,2)
fitvalues_table$TLI <-  round(fitvalues_table$TLI,2)
fitvalues_table$CFI <-  round(fitvalues_table$CFI,2)

fitvalues_table$Chisq <- (paste(fitvalues_table$Chisq, " (",fitvalues_table$df, ")", sep=""))
fitvalues_table$RMSEA <- (paste(fitvalues_table$RMSEA, " (",fitvalues_table$RMSEA_lo, "-", fitvalues_table$RMSEA_up, ")", sep=""))

fittable <- fitvalues_table %>% select("N", "Chisq", "p", "RMSEA", "SRMR", "TLI", "CFI") 
IV <- c("CRSE", "Expectations")
fittable <- cbind(IV, fittable)
colnames(fittable) <- c("Independent variable", "\\textit{N}", "\\chi^2(\\textit{df})", "\\textit{p}", "RMSEA (95\\% CI)", "SRMR", "TLI", "CFI")

print(xtable(fittable, type = "latex"), file = "outputs/fitvalues_medmodel_exploratory.tex", include.rownames = F , sanitize.text.function = force) 

# get indirect effects
ind_effects <- rbind(data.frame(fit_CDSE_estimates), data.frame(fit_expect_estimates))

ind_effects_table <-ind_effects  %>% select("Estimate", "lbound", "ubound")

names(ind_effects_table) <- c("Estimate", "Lower bound", "Upper bound")

ind_effects_table <- ind_effects_table[- grep("Var", rownames(ind_effects_table)),]

Paths <- c( "Exploration $\\rightarrow$ Goals", "CDSE $\\rightarrow$ Exploration", 
           "Exploration $\\rightarrow$ Goals", "Expectations $\\rightarrow$ Exploration")

ind_effects_table$Estimate <- formatC(ind_effects_table$Estimate, format = "f", zero.print = T, digits = 2) %>% gsub("0\\.", "\\.", .)
ind_effects_table$`Lower bound` <- formatC(ind_effects_table$`Lower bound`, format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)
ind_effects_table$`Upper bound` <- formatC(ind_effects_table$`Upper bound`, format = "f", zero.print = T, digits = 2)  %>% gsub("0\\.", "\\.", .)


indeffectstable <- cbind(Paths, ind_effects_table)

print(xtable(indeffectstable, type = "latex"), file = "outputs/indirect_effects_exploratory.tex", include.rownames = F , sanitize.text.function = force)
```



